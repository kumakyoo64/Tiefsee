!to "heim1.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 0
CHAR_COL2   !by 0
SPRITE_POS  !by 59,42,95,42,44,43,32,43,66,45,32,45,95,48,48,48,0
SPRITE_COL  !by 3,12,1,6,15,6,15,11,14,11
SPRITE_BG   !by 241
SPRITE_MC   !by 225
SPRITE_XS   !by 144

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B1BE

CHAR        !by 128,139,148,131,166,176,187,131,206,215,225,129,138,149,157,167,177,188,197,136,216,226,130,131,150,158,168,178,189,198,131,217,227,131,140,151,159,131,179,190,199,207,218,228,132,141,131,160,169,180,191,200,208,219,131,133,142,152,161,170,181,192,201,209,220,229,134,143,153,162,171,182,193,202,210,221,131,135,144,131,131,172,183,194,203,211,131,230,136,145,154,163,173,184,195,204,212,222,231,137,146,155,164,174,185,196,131,213,223,232,138,147,156,165,175,186,131,205,214,224,233
CHAR_COL    !by 14,14,12,12,12,11,12,12,12,14,14,14,12,12,12,11,11,12,12,11,12,14,12,12,12,12,12,11,12,12,12,15,6,12,12,12,12,12,12,12,12,3,15,12,15,12,12,3,11,3,3,3,15,15,12,15,12,12,3,3,3,3,3,15,12,12,12,15,12,12,3,3,15,3,15,12,12,12,12,12,12,3,3,3,3,12,12,12,15,12,12,15,12,3,3,12,11,11,6,14,12,12,12,15,3,12,12,12,12,14,14,14,12,12,12,12,12,12,12,14,6
CHAR_DATA   !by 1,1,131,199,255,255,255,255,254,252,248,240,224,192,192,128,15,31,63,63,127,127,255,255,255,255,255,255,255,255,255,255,0,0,8,0,0,0,0,0,0,0,0,0,0,0,64,0,255,255,255,255,255,255,255,247,255,255,255,255,255,255,127,255,0,0,0,0,0,1,0,0,128,192,192,224,240,120,60,62,63,127,255,255,255,255,255,255,255,254,248,240,224,192,128,0,255,255,255,253,255,255,255,191,255,191,255,255,255,255,255,255,127,255,255,255,255,255,252,240,0,0,13,18,30,2,0,0,255,255,255,253,255,255,253,255,223,255,183,255,255,255,255,255,255,255,255,255,255,255,127,63,0,128,192,224,240,248,254,255,3,15,55,127,255,255,255,255,191,255,255,255,255,255,239,255,255,247,255,255,255,255,255,255,251,255,255,255,239,255,255,255,254,252,240,224,198,6,30,255,224,128,0,63,255,191,255,255,127,255,239,255,255,255,255,255,255,255,252,249,231,255,255,127,255,253,255,255,127,63,15,3,127,255,255,255,247,255,255,255,255,255,255,255,255,126,254,252,252,248,248,240,240,224,224,192,30,30,31,63,29,31,29,127,255,255,255,128,128,128,67,115,5,0,64,192,252,255,255,223,0,0,0,0,0,2,0,22,143,63,255,255,254,252,254,254,255,255,255,248,241,255,255,255,255,255,255,255,255,251,255,255,0,128,0,128,16,0,0,0,255,255,143,31,31,63,63,127,2,0,64,0,0,0,0,0,255,255,247,11,30,95,250,235,127,255,255,254,222,0,0,0,1,1,1,0,3,1,6,6,241,243,230,132,12,24,112,225,36,72,16,32,64,0,129,132,240,131,15,63,255,255,255,255,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,2,0,0,0,0,0,0,0,255,255,255,255,255,255,255,224,127,253,183,255,255,255,250,242,199,139,247,254,252,254,253,252,249,248,166,143,27,60,124,115,212,210,192,69,143,29,30,61,121,243,231,207,159,29,29,60,57,121,43,119,246,44,220,144,207,223,255,255,255,255,255,255,255,255,191,239,255,255,255,255,255,255,255,255,255,255,251,255,255,231,255,255,255,255,255,239,255,255,255,255,255,251,255,0,239,255,255,251,127,255,127,223,175,247,245,221,235,54,112,241,60,197,178,27,207,201,3,3,28,31,127,255,181,127,243,159,251,251,83,247,78,184,120,240,31,31,127,63,255,255,253,255,127,191,255,255,255,251,255,255,223,255,255,255,255,239,255,255,255,255,255,255,255,253,252,0,255,11,135,215,211,178,249,68,247,133,110,248,155,31,18,154,86,55,247,62,123,78,220,164,253,239,203,61,255,254,244,248,7,15,31,63,239,255,255,255,255,223,255,255,255,255,255,255,224,248,254,255,255,255,239,255,1,7,15,63,127,255,255,255,1,0,37,97,0,128,128,224,112,0,128,208,96,152,200,32,48,232,152,8,72,64,208,32,31,63,63,127,126,255,255,255,0,0,0,0,128,0,0,0,255,255,251,254,255,255,255,255,239,255,255,255,254,252,240,192,255,127,31,15,7,3,1,0,252,254,255,247,255,255,255,255,0,0,0,0,0,0,0,198,0,0,192,0,0,17,2,13,4,216,96,128,0,0,0,0,255,254,255,127,255,255,223,255,255,255,255,253,255,255,255,255,0,0,0,128,0,0,0,0,255,255,255,255,255,255,254,252,0,1,3,7,15,31,127,255,7,143,255,255,255,255,255,255,127,63,31,15,7,3,3,1,6,7,3,3,1,1,0,0,127,63,63,63,62,127,127,255,255,255,255,223,255,255,255,255,255,207,255,255,255,255,255,255,0,0,1,1,3,3,7,14,1,3,3,7,15,31,63,127,0,0,0,1,7,31,31,31
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,252,255,255,255,255,255,255,0,255,207,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,253,63,255,241,255,255,245,255,255,245,255,255,244,255,255,199,255,255,215,255,255,199,255,255,0,215,255,255,23,255,255,87,255,255,23,255,255,83,255,255,83,255,21,95,241,85,95,197,101,92,86,21,81,81,85,70,85,89,85,85,85,69,85,65,85,85,0,85,84,212,85,84,5,85,21,21,51,229,83,252,81,65,242,85,80,5,65,65,0,197,5,65,17,85,69,81,85,65,65,84,209,21,80,215,199,83,71,255,255,65,255,241,65,255,241,10,255,244,202,255,196,58,255,196,233,255,192,229,255,199,212,255,207,97,255,208,93,255,31,116,255,29,69,255,93,197,255,113,16,252,68,213,0,241,84,80,244,211,68,211,80,65,79,79,77,63,124,68,253,125,68,253,252,55,245,241,16,247,253,19,199,243,207,247,247,127,247,215,63,255,84,255,252,76,255,241,127,255,196,255,255,79,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,120,3,128,56,0,224,0,0,112,0,0,56,0,0,0,12,0,0,6,0,0,3,0,0,1,128,0,0,192,0,0,96,0,0,48,0,0,24,0,0,28,0,0,14,0,0,6,0,0,3,0,0,3,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,3,0,0,7,0,0,6,0,0,14,0,0,28,0,0,24,0,0,48,0,0,96,0,0,192,0,1,128,0,3,0,0,6,0,0,28,0,0,56,0,0,240,3,1,224,15,7,128,15,31,0,15,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,1,0,0,0,0,0,0,0,0,0,128,0,0,0,1,0,0,8,0,0,0,0,8,16,0,0,4,0,0,32,0,0,0,0,0,64,0,0,0,0,0,0,128,0,0,0,0,1,0,0,0,16,0,2,16,0,2,0,0,2,0,0,2,2,0,0,8,0,0,32,0,0,0,0,2,32,0,8,0,0,0,0,0,0,0,0,0,0,1,247,152,3,128,2,0,132,8,34,27,192,144,8,65,0,1,128,136,4,4,16,208,138,48,36,1,128,224,0,32,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,0,0,0,0,4,0,0,8,0,0,0,34,0,0,8,0,1,96,0,5,2,0,12,4,0,48,1,0,32,2,1,128,20,0,0,32,0,0,8,8,0,8,0,0,0,0,32,6,0,0,8,0,0,100,0,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,124,124,0,240,56,3,192,48,7,128,0,14,0,0,28,0,0,0,48,0,0,96,0,0,192,0,1,128,0,3,0,0,6,0,0,12,0,0,28,0,0,56,0,0,48,0,0,112,0,0,224,0,0,192,0,0,192,0,0,128,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,128,0,0,192,0,0,0,192,0,0,224,0,0,112,0,0,48,0,0,56,0,0,28,0,0,12,0,0,6,0,0,3,0,0,193,128,0,192,192,0,128,96,0,0,48,0,0,28,0,0,14,0,0,7,128,0,3,192,0,0,240,0,0,124,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,128,0,0,0,0,64,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,0,64,0,0,0,0,0,8,0,0,64,0,128,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,128,16,0,0,33,0,0,65,0,0,145,0,0,1,0,0,1,0,0,66,1,0,0,1,8,122,4,48,128,0,64,28,16,132,28,64,32,76,128,0,12,0,0,22,0,7,2,0,6,159,0,9,132,128,28,94,2,68,122,0,2,39,16,162,220,0,3,120,0,99,119,0,194,126,0,4,222,128,3,21,0,0,19,132,0,48,178,2,37,116,0,3,26,0,18,43,0,20,62,0,10,35,128,44,8,0,44,13,0,60,19,0,65,97,0,97,2,0,40,70,0,65,132,0,102,68,0,4,72,0,45,200,0,40,16,0,17,160,0,147,96,0,43,0,0,0,34,64,0,214,128,0,71,128,0,152,0,64,149,0,32,6,0,0,18,0,0,32,32,0,68,0,0,8,0,128,200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,64,0,15,64,0,63,0,0,255,0,3,255,0,3,255,0,15,255,0,63,255,0,0,63,255,0,255,255,0,255,255,3,255,255,3,255,255,3,255,255,15,255,255,15,255,255,15,255,255,63,255,255,63,255,255,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,251,255,255,255,255,255,255,255,254,255,255,255,239,0,255,255,255,255,255,255,255,191,255,255,255,255,255,191,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,191,253,255,255,253,255,255,245,255,255,240,255,255,205,255,255,93,255,253,127,255,245,255,255,255,245,255,255,213,0,255,243,85,255,245,127,255,241,255,255,247,255,255,255,255,251,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,191,254,255,255,255,255,255,239,191,255,255,255,255,191,255,255,255,255,63,255,255,63,255,255,63,255,255,0,15,255,255,15,255,255,15,255,255,3,255,252,3,255,247,3,255,255,64,255,255,0,255,255,0,63,255,0,63,255,0,15,255,0,3,255,0,3,255,0,0,255,0,0,63,0,0,15,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,240,42,130,252,42,138,255,10,170,255,194,170,255,194,170,255,240,170,255,252,170,255,252,42,255,255,42,255,255,10,255,255,202,0,255,255,194,255,255,242,255,255,240,255,255,242,255,255,252,255,255,252,255,255,252,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,212,255,255,85,127,253,85,127,245,85,127,245,85,127,213,85,127,213,85,63,85,85,127,85,85,255,0,85,85,255,85,83,255,93,79,255,79,63,255,95,255,255,31,255,255,95,255,255,15,255,255,79,255,255,95,255,255,31,255,255,31,255,255,71,255,255,83,255,255,23,255,255,87,255,255,87,255,255,71,255,255,83,255,255,87,255,255,87,255,255,0,95,255,255,63,255,255,95,255,255,79,255,255,95,255,255,127,255,255,127,255,255,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,255,255,252,255,255,252,255,255,242,0,255,255,240,255,255,242,255,255,194,255,255,202,255,255,10,255,255,42,255,252,170,255,252,170,255,240,170,255,194,169,255,2,164,255,10,160,252,42,160,240,42,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,251,255,251,255,255,251,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,191,255,127,255,255,127,255,255,127,255,255,255,255,255,255,255,255,255,255,255,255,255,253,255,255,253,255,255,253,255,255,253,255,255,253,255,255,253,255,253,253,253,85,0,253,245,85,253,213,81,253,213,85,253,85,85,253,85,85,253,85,85,253,85,87,245,85,93,245,85,85,245,85,85,213,85,85,199,213,85,255,213,85,127,85,85,117,85,125,245,85,85,215,87,117,85,87,117,93,85,117,249,93,117,255,93,69,0,255,253,85,255,245,85,251,245,85,255,247,85,255,247,85,255,247,85,255,253,85,255,221,85,255,253,85,255,221,87,255,221,87,255,245,87,255,245,87,255,245,87,255,85,95,255,125,91,255,93,127,253,221,127,255,221,127,247,245,127,255,117,255,0,255,125,255,255,117,255,255,245,255,255,253,255,255,247,255,255,223,255,255,223,255,255,255,251,255,127,255,255,255,255,253,255,255,255,255,255,63,255,255,63,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
