!to "goldquest.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 15
CHAR_COL2   !by 14
SPRITE_POS  !by 32,42,81,42,59,43,95,43,46,45,41,45,71,48,32,48,0
SPRITE_COL  !by 12,15,9,8,6,1,8,13,13,8
SPRITE_BG   !by 245
SPRITE_MC   !by 197
SPRITE_XS   !by 240

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B2E6

CHAR        !by 128,128,128,128,128,128,128,128,180,180,180,129,133,133,133,133,133,133,133,180,180,194,130,134,142,148,155,162,155,155,162,187,195,130,135,143,149,156,163,169,175,181,188,195,130,136,144,150,157,164,170,176,182,189,195,130,137,145,151,158,165,171,177,183,190,195,130,138,146,152,159,166,172,178,184,191,195,130,139,147,153,160,167,173,179,185,192,195,130,140,140,154,161,168,174,154,154,193,195,131,141,141,141,141,141,141,141,186,186,196,132,132,132,132,132,132,132,132,186,186,186
CHAR_COL    !by 1,1,1,1,1,1,1,1,15,15,15,1,1,1,1,1,1,1,1,15,15,15,1,13,13,13,13,13,13,13,13,8,15,1,7,7,7,7,7,7,7,7,13,15,1,7,7,7,7,7,7,7,7,3,15,1,9,9,8,10,10,7,7,10,7,15,1,13,13,15,10,7,10,7,13,13,15,1,7,7,14,14,14,14,7,13,15,15,1,13,15,15,14,14,13,13,13,7,15,1,1,1,1,1,1,1,1,15,15,15,1,1,1,1,1,1,1,1,15,15,15
CHAR_DATA   !by 255,0,0,0,0,0,0,0,0,0,0,0,0,127,64,64,64,64,64,64,64,64,64,64,64,64,127,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,0,0,0,255,0,0,0,0,0,0,0,0,127,127,0,1,3,1,1,1,1,0,1,1,1,3,0,0,0,0,0,0,8,4,2,1,0,0,126,126,126,62,63,127,127,127,0,0,0,0,0,96,0,0,127,127,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0,255,248,4,64,160,11,116,54,247,0,130,130,151,244,0,0,0,0,0,0,0,0,0,0,128,64,205,7,19,31,15,255,255,255,0,0,0,128,128,0,0,0,0,0,0,0,0,0,255,15,0,97,97,103,173,173,103,0,0,20,93,4,2,0,0,0,255,255,127,127,63,7,0,0,0,0,0,0,0,0,31,63,0,0,0,0,0,0,3,15,255,255,0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,128,173,8,10,15,7,0,0,34,90,48,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,176,4,0,0,0,3,15,31,122,255,227,7,0,0,0,0,0,0,0,0,0,0,0,0,0,255,254,0,0,128,150,154,154,222,0,0,2,118,0,0,0,0,0,0,0,0,0,0,0,0,32,0,8,0,0,0,16,16,16,0,0,0,236,255,0,192,255,222,0,0,0,0,0,0,0,0,7,0,103,254,199,239,16,1,17,217,0,0,0,0,0,0,0,0,0,32,32,0,128,0,0,0,0,0,2,12,0,0,0,4,56,192,16,96,128,63,31,0,0,0,0,0,0,0,185,97,96,96,96,96,0,0,0,46,1,0,0,0,0,0,0,8,0,1,0,0,0,16,128,0,0,0,0,0,0,0,0,0,0,0,3,224,0,0,255,255,255,255,0,0,0,1,182,54,167,183,231,70,0,8,132,180,255,0,128,0,0,0,0,0,0,168,24,8,16,135,135,7,15,15,31,63,255,255,255,255,255,255,127,255,255,0,0,0,255,255,255,255,0,0,0,0,0,0,0,0,192,254,254,254,254,254,254,254,254,0,0,0,0,0,0,0,16,0,112,240,240,96,0,6,4,254,230,254,126,62,30,158,158,32,48,16,0,0,0,0,0,48,0,0,0,0,0,0,0,0,255,255,255,255,1,1,1,1,1,1,1,1,1,1,1,1,1,1,255,255,255,255,0
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,0,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,16,0,192,16,0,192,0,0,192,0,0,192,1,60,192,0,12,0,192,0,28,192,3,35,192,3,212,192,3,244,192,3,240,192,0,240,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,3,192,0,3,192,0,3,192,0,15,192,0,15,192,0,63,192,0,63,192,0,63,192,0,0,192,0,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,192,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,64,0,12,192,140,146,0,127,61,146,49,62,32,3,62,128,113,62,0,33,63,82,31,255,192,61,243,224,221,254,246,77,162,150,255,252,0,255,252,0,255,248,0,255,254,0,255,254,0,255,255,224,255,255,224,240,15,240,192,5,240,128,0,161,128,1,192,128,0,232,0,0,0,216,0,64,208,32,192,144,49,64,176,49,193,225,23,131,224,27,159,192,35,255,0,191,254,0,127,240,0,240,224,0,193,192,0,4,0,0,0,0,0,0,1,0,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,252,60,0,252,60,0,255,255,0,255,255,192,255,63,192,255,64,115,243,0,2,252,42,170,240,2,168,64,240,3,255,1,15,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,112,1,0,112,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,128,18,6,128,99,143,133,99,175,191,247,127,247,222,255,143,0,222,231,183,23,114,167,15,254,31,191,254,158,239,255,255,230,253,190,15,223,255,14,159,255,6,15,255,6,31,255,6,63,255,7,255,255,7,255,255,3,255,225,3,255,192,3,255,192,0,255,192,0,63,192,0,31,128,0,30,2,0,30,4,0,2,60,4,0,248,4,0,252,12,1,214,29,0,54,7,0,50,63,0,0,126,0,0,118,0,0,100,128,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,252,127,255,251,62,127,231,12,20,231,8,24,224,0,0,224,0,0,0,224,0,0,224,0,0,252,0,56,232,0,56,228,0,0,228,0,0,228,0,0,255,124,0,255,126,0,255,60,0,255,56,0,255,0,0,255,0,0,191,0,3,191,0,7,219,128,7,249,192,7,249,240,15,241,248,15,255,248,63,227,184,63,0,231,240,251,231,225,251,247,192,122,255,192,124,255,128,120,255,128,112,255,0,112,254,0,48,254,0,48,236,0,17,236,0,3,124,0,7,248,0,6,248,0,15,240,0,15,240,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,160,170,170,160,42,170,160,10,0,160,8,0,160,0,10,160,0,2,160,0,2,160,0,2,160,8,2,160,0,8,34,160,0,0,160,0,0,160,0,0,160,0,10,160,0,42,160,0,10,160,0,10,160,0,2,160,0,2,224,2,162,160,2,162,160,2,162,160,2,170,160,10,170,160,10,170,160,10,170,160,42,170,160,170,170,160,170,170,160,42,162,96,0,234,162,96,232,10,96,232,10,224,232,42,160,251,234,160,251,42,160,56,170,160,3,170,160,2,170,160,2,42,160,14,170,160,78,170,160,254,170,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,0,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,2,0,170,42,0,138,42,0,138,170,2,170,170,2,170,170,2,170,138,0,42,170,0,42,170,0,2,170,170,2,170,170,2,138,170,0,42,170,0,42,42,0,8,42,0,10,42,0,10,170,0,10,170,0,10,170,0,10,170,6,10,170,2,122,170,1,242,170,0,240,170,0,112,170,3,48,170,3,218,168,3,216,168,3,194,160,0,194,168,0,0,2,184,0,15,248,0,15,252,0,15,252,0,63,255,0,63,223,2,63,199,2,63,64,0,63,192,0,255,0,0,252,240,0,255,215,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,0,0,255,255,255,255,255,255,255,255,255,255,255,255,85,85,85,0,0,0,0,0,0,85,85,85,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
