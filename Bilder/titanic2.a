!to "titanic2.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 24
CHAR_COL1   !by 14
CHAR_COL2   !by 15
SPRITE_POS  !by 71,42,32,42,95,43,95,43,32,45,32,45,71,48,52,48,0
SPRITE_COL  !by 11,15,12,12,14,12,14,3,6,12
SPRITE_BG   !by 96
SPRITE_MC   !by 100
SPRITE_XS   !by 96

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B24E

CHAR        !by 128,135,141,146,157,131,131,131,183,194,205,129,136,131,147,158,131,131,131,184,195,206,130,131,131,148,159,131,131,131,185,196,207,131,131,131,149,160,131,131,177,186,197,208,131,131,131,150,161,131,131,178,187,198,209,131,131,131,151,162,131,172,179,188,199,210,131,131,131,152,163,168,173,180,189,200,211,131,137,142,153,164,169,174,131,190,201,212,132,138,143,154,165,170,175,181,191,202,213,133,139,144,155,166,171,176,182,192,203,214,134,140,145,156,167,131,131,131,193,204,215
CHAR_COL    !by 6,6,6,8,8,0,0,0,14,6,14,6,6,0,8,8,0,0,0,8,14,14,6,0,0,8,8,0,0,0,9,8,6,0,0,0,8,8,0,0,8,8,8,8,0,0,0,8,8,0,0,8,8,8,9,0,0,0,8,8,0,8,8,8,0,8,0,0,0,8,8,0,0,8,8,8,8,0,0,0,0,0,0,0,0,9,9,8,6,0,1,1,9,1,1,1,9,8,14,6,6,1,1,9,9,1,1,8,14,14,6,6,6,8,8,0,0,0,6,6,14
CHAR_DATA   !by 254,124,56,48,0,0,0,0,0,1,3,6,12,28,56,48,112,224,192,192,128,128,0,0,0,0,0,0,0,0,0,0,0,0,128,128,192,192,224,112,48,56,28,12,6,3,193,192,128,0,0,0,0,0,0,0,0,0,3,7,14,28,48,96,192,128,0,0,0,0,0,0,0,0,0,0,0,0,0,15,63,63,191,223,159,95,80,0,0,0,0,0,0,0,128,192,96,48,28,14,7,3,0,0,124,240,192,128,0,0,0,0,0,0,0,3,3,31,255,255,0,0,0,0,0,0,2,158,254,254,102,34,2,0,0,0,0,0,0,0,128,192,240,124,0,0,160,0,0,0,0,32,32,0,128,8,0,0,0,0,0,0,0,160,170,10,0,0,0,0,160,0,170,2,10,160,0,0,128,0,160,170,138,128,0,2,42,170,138,160,0,10,0,0,0,0,0,0,0,8,0,0,15,255,255,255,253,255,0,0,0,0,48,63,183,223,223,95,111,15,15,13,1,1,160,0,0,0,0,8,168,0,0,0,0,0,0,0,138,0,0,0,0,32,0,0,0,0,0,0,0,0,160,0,0,0,0,0,0,0,160,160,138,0,0,0,32,0,0,160,128,0,0,128,0,0,0,0,160,32,0,0,0,0,0,0,128,0,3,127,255,255,255,255,248,192,8,0,0,131,63,192,255,255,255,255,255,195,192,200,192,0,0,160,0,0,0,0,0,0,0,0,0,0,0,0,7,127,255,255,255,252,224,0,0,0,0,1,0,193,11,15,7,7,207,207,195,3,2,2,0,0,0,0,2,2,0,0,0,2,0,0,0,7,31,255,255,255,254,224,128,0,0,0,0,0,0,0,96,224,224,240,112,112,0,128,128,128,128,64,64,0,0,0,0,0,138,0,0,2,0,0,0,2,0,0,0,35,48,0,32,32,192,0,0,32,0,0,0,0,2,0,0,0,112,240,112,48,56,56,56,24,0,24,0,0,0,0,0,0,48,143,163,168,170,170,170,170,138,170,170,170,170,170,170,138,170,170,138,162,12,168,40,168,131,0,130,170,32,2,234,3,128,0,128,128,50,138,130,12,0,0,160,163,160,172,172,48,192,131,0,224,40,170,0,0,2,42,131,163,163,35,51,51,50,58,50,62,140,138,0,128,0,130,0,0,0,128,160,0,0,0,0,0,1,3,15,62,0,0,192,224,112,56,12,6,163,168,170,170,160,160,170,170,170,170,170,128,170,42,40,160,0,0,0,0,0,0,3,162,2,10,2,8,10,10,0,0,0,0,2,8,97,0,4,4,0,3,0,3,2,170,42,10,170,188,192,248,240,202,204,40,168,160,128,10,0,0,0,10,0,0,0,0,0,2,0,3,6,12,56,112,224,192,0,0,49,53,85,85,85,85,85,85,21,21,197,5,49,49,129,172,14,7,3,3,1,1,0,0,14,34,34,42,42,160,160,162,170,10,14,42,2,10,10,10,2,50,2,192,0,170,42,170,42,10,170,162,170,234,10,130,0,0,168,0,2,2,130,2,42,2,3,43,3,35,47,0,12,1,1,49,5,197,21,21,85,85,85,87,83,67,67,67
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,96,0,0,0,192,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,1,252,0,0,0,0,0,0,0,0,0,0,0,192,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,120,0,0,68,0,0,132,254,121,136,96,0,135,0,0,192,0,0,112,0,0,0,8,72,0,56,0,1,120,0,0,208,0,0,240,0,0,120,0,4,120,0,17,12,0,24,4,96,72,7,224,36,255,240,0,0,16,2,0,0,2,0,0,0,32,0,0,49,0,0,11,0,15,235,1,248,0,31,192,2,124,0,1,192,0,1,0,0,15,0,0,127,0,3,254,0,63,255,0,252,254,7,255,248,63,255,231,255,158,230,255,255,199,255,252,7,255,102,3,243,207,3,0,7,3,0,0,7,0,16,7,0,120,3,129,120,3,128,60,27,127,60,26,192,28,25,240,28,12,13,208,15,131,130,7,247,142,3,249,204,63,255,255,255,255,255,255,255,255,255,255,255,222,127,255,255,255,255,255,249,192,3,227,0,0,223,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,255,0,1,31,0,4,3,0,0,0,0,31,192,0,0,255,0,0,60,0,0,0,0,0,0,0,0,0,0,0,0,0,3,128,0,0,0,0,31,254,0,3,252,0,0,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,1,192,0,0,0,63,0,0,63,1,0,20,240,2,0,0,64,0,128,0,4,0,0,0,0,0,1,0,2,9,0,63,253,1,31,237,224,127,237,0,255,191,0,142,255,1,255,230,1,255,242,1,255,182,16,63,182,0,0,16,0,12,0,0,0,0,0,30,1,128,15,240,2,11,128,0,3,192,0,0,0,0,0,4,0,0,0,0,248,0,0,128,0,31,128,0,31,0,0,120,0,63,240,0,255,128,3,252,0,3,192,0,7,128,0,254,0,0,14,0,0,6,0,1,0,3,0,8,3,0,64,3,2,0,3,136,0,11,192,0,0,14,0,3,3,0,1,252,0,0,31,0,0,255,224,0,96,120,0,63,191,0,0,255,0,15,255,0,3,255,0,0,63,0,0,97,0,0,29,0,0,7,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,170,130,240,42,130,252,10,170,255,10,170,255,194,170,255,194,170,0,255,240,170,255,252,42,243,252,42,255,255,42,255,255,10,255,255,194,255,252,2,255,240,194,255,255,242,243,255,240,243,255,240,255,255,252,243,255,204,240,240,252,192,255,255,252,63,252,204,60,60,204,49,113,195,4,64,0,5,67,195,16,76,0,255,0,15,60,17,15,76,0,60,77,4,240,16,240,240,192,3,247,192,3,195,192,3,195,196,3,15,192,3,195,195,19,19,192,16,3,81,0,7,0,68,0,196,0,16,240,68,68,240,1,68,241,0,16,240,16,63,241,84,63,16,4,63,0,64,80,15,1,16,207,1,80,63,48,0,60,12,3,124,51,63,63,0,15,15,12,15,48,0,255,0,15,240,0,48,48,204,240,15,0,243,12,0,51,207,3,15,204,192,0,63,0,0,252,15,1,252,0,1,240,0,3,195,63,0,0,0,0,3,0,48,0,0,12,192,3,192,0,0,0,195,192,2,0,0,2,0,0,2,0,0,2,192,0,10,48,0,42,0,0,42,0,12,42,0,0,170,0,2,170,0,2,168,0,10,168,0,10,160,0,42,160,0,170,160,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,14,0,0,0,0,4,0,0,12,0,0,0,0,0,4,0,16,13,6,0,18,0,0,2,128,2,18,131,195,50,8,12,40,18,50,101,96,40,40,202,33,0,0,157,160,129,204,96,33,23,65,146,98,14,76,5,4,39,120,8,25,80,20,9,120,24,3,124,112,2,252,24,12,204,68,54,141,116,8,173,240,191,35,218,19,102,102,9,50,48,1,88,24,4,201,23,4,137,64,9,1,128,101,209,192,0,141,13,176,88,4,32,208,14,0,14,123,65,243,248,130,76,192,128,219,144,224,225,160,199,250,0,189,240,2,255,196,6,51,14,0,127,14,1,254,142,0,248,134,0,62,199,0,126,71,3,240,160,1,255,177,7,255,144,28,128,19,255,254,0,20,255,142,191,255,240,55,252,24,255,255,152,56,31,224,127,255,224,255,231,224,255,155,192,63,255,0,207,239,0,255,222,0,255,176,0,255,248,0,255,224,0,255,192,0,255,0,0,254,0,0,248,0,0,224,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,0,1,254,0,131,248,0,199,240,0,255,224,0,255,192,0,255,128,0,255,0,0,0,254,0,0,252,0,0,248,0,0,240,0,0,224,0,0,192,0,0,192,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,192,0,0,192,0,0,224,0,0,240,0,0,120,0,0,60,0,0,62,0,0,63,0,0,127,128,0,255,192,0,255,224,0,255,240,0,255,248,0,255,254,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,128,63,255,128,243,255,0,255,255,3,255,255,3,255,255,3,3,15,15,195,63,0,15,243,255,15,255,255,12,243,255,63,12,63,63,255,255,63,255,255,63,255,255,63,255,255,63,255,255,255,255,255,255,255,255,252,51,255,255,48,63,255,60,255,255,255,255,255,255,255,255,255,255,255,255,255,255,243,255,255,255,255,255,192,63,0,255,192,3,255,240,15,63,243,255,255,255,255,255,255,255,255,240,63,255,255,255,255,243,243,252,48,51,252,240,15,252,240,3,240,64,51,245,0,63,240,240,255,240,48,252,240,240,240,252,243,255,255,255,63,255,252,63,255,255,255,255,255,255,0,195,255,255,255,255,255,255,255,252,255,255,241,255,255,5,255,252,4,63,240,16,255,193,64,255,196,0,255,208,1,252,16,4,240,64,4,241,1,16,244,0,64,244,0,0,20,0,0,212,0,15,244,12,63,244,63,255,244,252,252,245,255,3,0,55,252,3,63,60,0,63,60,0,15,252,63,51,252,253,60,252,241,128,255,193,15,255,15,0,192,15,15,3,0,0,0,0,0,0,0,3,192,0,0,240,0,0,240,0,0,48,15,0,63,255,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,254,8,255,255,8,255,255,0,255,255,128,255,255,192,255,255,224,255,255,240,255,255,240,255,255,240,255,255,248,255,255,240,0,255,255,248,255,255,252,255,255,254,255,63,254,255,255,252,255,255,255,255,255,255,255,255,255,255,253,255,255,255,255,255,252,255,255,252,255,255,253,93,255,247,213,255,255,87,255,255,87,255,127,87,255,95,87,63,207,87,255,247,93,255,245,221,0,255,245,255,255,253,221,255,245,255,255,245,255,255,253,63,127,247,117,63,253,117,127,213,83,255,220,85,255,253,87,255,125,85,255,125,84,3,253,19,255,253,87,255,253,95,255,127,223,255,245,71,255,245,95,252,68,71,241,13,127,196,3,63,0,212,15,255,80,15,255,64,15,255,0,65,255,1,51,208,0,15,255,19,60,60,16,63,51,64,255,243,7,255,255,0,252,255,3,204,243,15,253,240,48,255,240,243,255,255,243,247,2,240,247,14,63,252,3,63,255,62,15,64,12,15,255,206,0,255,60,10,223,240,248,220,240,248,223,60,0,255,60,200,252,0,224,0,0,240,0,0,0,0,0,160,15,192,128,0,0,130,0,50,2,255,242,2,255,202,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,32,0,0,255,3,128,252,15,24,60,0,0,0,0,0,3,0,0,0,240,62,0,192,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,225,0,0,201,162,1,192,128,0,0,0,0,0,0,0,0,0,0,0,0,0,113,0,8,0,0,0,250,134,0,255,230,255,79,131,140,8,0,0,0,0,0,0,64,0,0,3,252,1,16,0,7,154,0,15,218,146,26,219,87,254,211,255,239,255,255,15,255,195,1,109,96,0,41,64,0,107,128,31,104,0,0,0,6,0,0,28,0,0,0,0,0,0,0,32,0,0,0,0,0,0,0,3,0,0,0,15,0,3,248,0,127,224,15,254,0,255,192,0,240,0,0,128,0,0,0,0,0,0,0,7,0,0,63,0,1,255,0,15,127,0,127,255,3,255,254,25,247,0,128,0,0,0,0,2,0,0,15,0,0,15,0,0,7,0,0,7,0,0,0,3,0,0,3,0,0,26,0,0,48,128,3,241,255,207,249,248,15,255,255,249,255,255,255,255,255,255,255,31,255,255,223,191,255,120,127,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
