!to "schrank.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 0
CHAR_COL2   !by 0
SPRITE_POS  !by 64,42,50,42,68,43,71,43,32,45,32,45,71,48,32,48,0
SPRITE_COL  !by 8,11,9,6,0,9,9,12,12,14
SPRITE_BG   !by 238
SPRITE_MC   !by 230
SPRITE_XS   !by 110

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B26E

CHAR        !by 128,136,145,152,159,167,145,145,145,145,145,129,137,146,153,160,168,177,184,191,198,203,130,138,147,154,161,169,178,185,192,199,204,131,139,148,155,162,170,131,131,193,200,205,132,140,132,132,141,171,179,186,194,201,206,132,141,132,132,163,172,180,187,132,132,207,132,142,132,132,141,173,181,188,195,132,208,133,143,149,156,164,174,141,189,132,132,209,134,144,150,157,165,175,182,157,196,202,210,135,129,151,158,166,176,183,190,197,129,211,132,132,132,132,132,132,132,132,132,132,132
CHAR_COL    !by 6,6,6,14,14,14,6,6,6,6,6,8,8,8,9,8,8,8,8,11,11,8,8,8,8,9,8,8,8,9,8,8,8,9,9,8,9,9,8,9,9,9,8,9,9,8,8,8,9,8,9,9,8,8,9,9,8,8,8,9,8,9,8,8,8,9,9,8,8,8,9,8,9,8,8,8,9,9,9,8,9,9,8,9,9,8,8,9,8,8,8,9,9,8,9,9,9,8,9,0,12,15,15,0,15,12,15,8,12,9,12,12,12,12,12,12,12,12,12,12,12
CHAR_DATA   !by 243,159,230,255,255,251,255,0,0,0,0,0,255,255,255,255,254,255,255,255,255,255,0,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,253,254,255,255,255,255,255,255,0,0,0,103,255,255,255,255,15,12,8,0,0,0,0,0,255,255,127,159,255,255,255,0,0,0,0,0,255,255,255,127,63,127,255,255,255,255,0,255,0,0,255,255,255,255,227,192,151,31,63,63,63,127,127,127,127,127,127,127,127,127,127,127,127,127,63,63,63,63,63,63,192,240,240,144,196,225,255,255,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,191,191,191,255,191,191,191,191,191,255,0,255,255,255,0,0,15,63,255,255,255,255,255,255,255,127,7,0,0,0,0,135,255,255,255,255,0,0,0,0,0,31,0,0,0,0,0,0,0,24,0,0,224,252,255,0,0,0,0,16,40,16,0,0,0,0,255,0,0,0,255,255,7,1,1,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,254,0,25,0,0,0,0,0,255,247,247,255,247,247,247,247,247,255,0,255,0,0,255,255,254,255,255,255,127,126,127,127,126,127,127,127,127,126,127,126,124,124,252,252,252,252,252,254,255,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,0,0,0,0,255,255,255,251,241,251,255,255,255,255,0,239,239,239,238,238,238,239,238,238,238,238,238,239,238,239,239,239,239,238,239,239,238,238,110,238,238,238,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,239,238,239,239,0,0,0,0,0,192,238,0,0,0,0,0,253,255,253,253,253,255,253,253,253,253,0,255,255,255,255,255,255,255,127,127,255,255,127,255,255,255,63,63,255,255,255,127,127,127,127,127,127,127,127,127,255,224,0,0,0,0,0,31,255,255,255,255,0,0,0,0,255,255,255,254,2,1,0,0,0,0,255,0,255,255,248,248,240,224,224,224,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,15,241,240,246,252,252,248,248,255,0,0,0,0,30,248,0,0,255,143,128,255,0,0,0,0,127,255,255,255,255,255,0,255,0,0,255,255,255,252,192,128,127,255,255,255,255,255,255,255,255,255,255,255,255,255,239,127,252,255,255,255,255,0,0,0,63,0,0,0,0,0,0,0,255,1,128,255,0,0,0,0,127,127,127,255,127,127,0,255,255,255,0,0,0,255,255,255,255,255,253,255,254,255,255,255,255,126,0,0,0,255,255,255,0,0,0,0,255,255,255,191,31,191,255,255,255,255,0,255,0,0,255,255,255,127,15,15,7,3,3,15,127,63,63,31,15,27,31,15,27,15,13,7,7,7,3,3,3,3,7,7,7,7,7,3,3,7,15,15,31,255,255,255,255,0,0,0,9,11,9,9,13,13,0,0
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,7,199,248,7,252,35,129,249,0,0,0,0,0,2,8,0,0,8,0,2,0,4,2,8,10,2,8,4,0,8,0,2,8,0,2,8,0,2,0,0,2,255,255,255,0,16,0,0,16,0,0,16,0,0,255,17,255,255,17,255,254,17,255,255,16,255,255,17,255,255,17,255,127,17,255,127,17,255,127,17,255,127,16,255,127,17,255,127,16,255,127,16,127,127,16,127,127,16,255,126,17,255,127,16,127,127,16,255,126,17,255,127,17,255,127,145,63,0,127,17,63,127,17,255,127,17,255,127,16,255,127,16,127,127,16,127,127,16,127,127,16,127,127,16,127,127,16,127,126,16,127,127,16,127,126,16,127,124,16,127,124,16,127,252,16,127,252,16,127,252,16,127,252,16,127,252,16,127,254,16,127,0,255,16,255,0,17,224,0,16,0,0,16,0,0,16,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,170,170,170,170,170,170,170,170,170,170,170,42,170,0,170,170,170,170,162,170,15,255,255,15,252,207,3,252,0,3,255,192,255,255,255,85,85,85,85,85,85,85,85,85,85,85,84,81,81,84,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,85,85,85,85,85,85,85,85,85,0,0,21,0,0,21,0,20,21,0,85,21,0,85,21,0,85,21,1,85,21,0,85,21,1,85,21,5,85,21,5,85,21,5,85,21,5,85,21,5,85,21,5,85,21,1,85,21,1,85,21,1,85,21,1,85,21,1,85,21,1,85,20,1,0,85,20,1,85,21,1,85,21,1,85,21,1,85,21,1,85,21,1,85,21,1,85,21,1,85,21,0,85,21,5,85,21,5,85,21,5,85,21,1,85,21,1,85,21,5,21,21,5,0,21,1,0,21,0,0,21,0,0,21,0,16,21,0,0,80,21,0,85,85,85,85,85,85,85,85,85,79,85,60,255,255,255,255,255,255,240,63,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,252,15,255,207,252,252,192,195,252,192,3,255,255,255,85,85,85,85,85,69,85,85,69,85,81,84,89,88,68,85,85,68,85,85,69,85,85,85,85,85,69,85,85,69,0,0,0,85,85,85,85,85,85,85,85,85,20,0,0,0,20,0,0,84,0,0,20,0,85,20,1,85,20,1,85,20,0,85,20,1,85,20,5,81,20,5,85,20,5,81,20,21,85,21,21,85,21,21,85,20,5,85,84,5,85,21,5,85,20,5,85,84,5,85,20,5,85,22,5,85,22,5,85,0,20,5,85,20,5,85,20,5,85,21,5,85,21,5,85,21,5,85,21,4,85,21,4,85,21,5,85,85,5,85,21,5,85,85,5,85,85,5,85,85,5,85,85,5,85,85,1,85,85,0,85,85,0,0,85,0,0,85,0,0,20,0,0,0,85,85,85,85,85,85,85,85,85,85,250,85,255,255,254,255,255,255,255,3,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,192,29,192,3,31,230,241,142,255,251,0,0,0,1,0,0,0,0,128,1,0,128,17,8,4,49,24,140,16,8,132,1,0,128,1,0,0,1,0,128,1,0,128,255,255,255,32,0,0,32,0,0,32,0,0,175,255,255,0,175,255,255,47,255,255,175,255,7,175,252,3,175,248,3,175,248,1,175,248,0,175,224,16,175,224,3,175,224,15,175,192,7,167,192,7,167,192,3,175,192,3,47,192,2,167,192,3,175,192,3,47,192,2,175,192,3,175,192,2,175,192,1,0,175,192,1,175,192,1,175,192,0,167,192,0,167,192,0,167,192,0,167,194,1,167,232,1,167,232,1,39,224,1,167,240,1,39,240,0,39,240,0,39,224,1,39,224,3,39,248,3,39,255,3,39,255,143,39,255,255,39,255,255,175,255,255,0,44,0,0,32,0,0,32,0,0,34,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,1,255,0,0,63,255,252,255,255,227,255,255,0,0,0,0,0,64,0,0,64,0,0,64,0,128,0,1,64,64,0,128,64,0,0,64,0,0,64,0,0,64,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,240,0,255,255,192,255,227,0,255,192,0,255,104,0,255,224,0,255,192,0,255,192,0,255,192,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,255,128,0,0,255,192,0,255,192,0,255,192,0,255,192,0,255,192,0,255,192,0,253,192,0,254,240,0,255,240,0,255,144,0,255,196,0,255,225,128,255,255,248,255,255,255,255,255,255,255,255,255,255,255,255,152,0,120,0,0,0,0,0,0,0,0,0,0,0,0,0,176,16,0,144,0,0,144,0,0,208,0,0,144,0,0,208,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,15,255,0,252,15,255,48,3,63,240,0,255,255,255,255,85,85,85,85,85,85,85,85,85,85,85,85,81,81,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,85,85,85,85,85,85,85,85,85,0,0,5,0,0,5,0,21,21,0,0,85,5,5,85,5,5,85,5,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,85,5,85,69,5,85,69,5,85,85,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,0,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,5,85,69,21,85,69,17,85,85,1,85,69,5,85,85,5,85,85,5,85,85,0,21,21,0,0,21,0,0,21,0,0,21,0,0,21,85,80,21,85,80,5,85,85,85,85,85,85,0,85,85,85,71,31,213,127,255,255,127,255,255,127,254,191,106,170,170,106,128,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,252,63,255,255,252,243,255,207,243,12,207,0,255,255,255,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,85,85,85,85,85,85,85,85,85,80,0,0,80,0,0,80,0,0,84,1,84,80,5,85,80,5,85,0,80,5,85,80,5,85,80,21,85,84,21,85,80,21,84,84,21,84,84,21,84,84,21,84,84,21,85,80,21,85,84,21,84,84,21,85,80,21,85,80,21,85,80,21,85,80,21,85,80,21,85,80,21,85,84,21,85,84,21,85,84,21,85,0,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,21,85,84,5,85,84,1,84,84,0,80,84,0,0,84,0,0,84,0,0,81,85,85,85,85,85,85,85,85,87,245,85,255,255,253,0,255,255,253,254,171,253,170,138,169,170,170,169,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,160,0,0,42,128,0,0,160,0,0,0,0,8,0,0,0,0,0,63,255,0,255,192,0,3,0,0,60,0,0,0,255,255,255,85,85,85,85,85,85,85,85,85,85,85,85,85,21,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,85,85,85,85,85,85,85,85,85,0,0,0,0,0,0,0,0,5,0,0,21,0,20,85,0,21,85,0,0,85,85,0,21,85,0,21,85,0,21,85,0,21,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,85,85,0,21,85,0,21,85,0,21,85,0,0,21,85,0,21,85,0,21,85,1,21,85,1,5,85,0,5,85,0,85,85,0,21,85,0,21,85,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,85,85,69,85,85,85,85,85,85,85,85,85,85,85,85,64,95,21,83,255,255,0,95,255,255,31,255,255,80,0,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
