!to "knopf.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 0
CHAR_COL2   !by 0
SPRITE_POS  !by 36,42,60,42,59,43,89,43,32,45,95,45,33,48,48,48,0
SPRITE_COL  !by 1,15,1,12,2,12,12,11,0,11
SPRITE_BG   !by 228
SPRITE_MC   !by 228
SPRITE_XS   !by 128

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B256

CHAR        !by 128,138,149,156,163,173,181,181,194,198,204,129,139,150,157,143,143,143,143,143,143,205,129,140,151,143,164,174,182,143,143,143,206,130,141,143,158,165,175,183,190,143,143,207,131,142,152,159,166,176,184,191,143,199,208,132,143,143,160,167,177,185,192,195,200,209,133,144,153,143,168,178,186,143,196,201,210,134,145,154,143,169,143,187,143,197,202,211,135,146,143,143,170,179,188,143,143,203,212,136,147,155,161,171,143,143,143,143,143,213,137,148,148,162,172,180,189,193,172,172,214
CHAR_COL    !by 12,12,12,12,12,12,12,12,12,1,12,12,11,15,12,15,15,15,15,15,15,12,12,15,15,15,11,0,11,15,15,15,12,15,15,15,0,0,0,15,15,15,15,12,12,15,11,0,0,0,15,15,15,15,12,15,15,15,12,0,0,0,15,15,15,12,12,15,15,15,0,15,15,15,15,15,12,15,15,15,15,15,2,2,15,15,15,12,1,15,15,15,0,2,0,15,15,15,12,12,15,15,12,15,15,15,15,15,15,12,12,1,1,12,1,1,12,12,1,1,12
CHAR_DATA   !by 255,128,191,160,160,160,160,161,161,161,161,161,161,161,161,161,22,22,23,23,23,23,23,22,160,160,161,163,162,166,173,170,3,11,7,23,47,15,31,63,192,128,255,128,191,160,160,160,23,22,22,22,22,23,23,23,72,73,75,74,78,76,76,76,163,162,166,165,165,164,164,166,163,160,160,160,160,191,128,255,255,0,255,0,0,0,0,255,0,0,60,40,56,48,32,0,183,174,205,216,154,176,117,104,194,213,129,171,163,7,87,143,47,95,63,191,127,127,255,255,255,255,255,255,255,255,255,255,255,255,255,7,16,192,31,193,248,58,116,105,194,213,161,11,87,135,47,95,31,191,63,63,127,127,127,255,255,255,128,0,0,0,255,255,0,0,255,0,255,0,255,6,5,4,5,134,52,185,58,116,233,210,133,171,67,151,47,95,191,63,127,255,0,0,0,0,0,0,0,1,255,255,255,227,3,23,175,15,95,191,127,127,255,255,255,255,255,255,255,255,255,255,0,0,255,0,255,31,224,7,0,64,160,192,160,64,128,0,0,0,0,0,0,0,0,30,8,8,8,8,8,0,0,0,0,241,32,39,34,40,44,0,0,0,0,0,0,0,0,0,224,15,240,31,0,0,0,255,0,255,255,0,255,192,127,128,0,0,0,0,0,0,3,2,0,0,15,0,0,0,0,158,136,136,136,136,136,0,0,0,0,16,16,16,144,144,0,0,0,0,0,0,0,0,0,0,1,2,240,240,240,240,240,240,240,240,0,4,2,1,0,0,0,0,255,255,255,255,255,255,255,3,255,0,0,255,0,0,255,0,255,0,255,0,255,0,127,0,0,0,0,32,32,32,32,32,0,0,0,0,0,34,67,2,146,242,2,0,0,0,0,1,65,65,65,65,1,0,0,0,255,255,255,255,255,0,0,0,255,255,255,255,24,0,0,0,128,63,0,128,0,0,255,0,255,0,255,0,255,0,255,0,0,0,0,32,0,0,0,0,103,255,255,255,255,155,155,26,26,27,155,255,255,255,255,204,2,227,2,2,3,0,0,0,255,255,255,255,255,127,63,31,192,224,224,224,240,240,224,224,0,32,64,128,0,0,0,0,255,0,255,0,0,255,0,255,255,255,255,255,255,143,63,127,127,63,143,255,255,255,255,36,228,32,232,232,44,255,255,255,248,7,252,0,0,255,0,255,255,0,255,0,255,0,192,0,255,255,255,255,255,255,254,254,252,249,248,250,244,233,226,241,244,250,253,252,254,255,255,255,0,255,0,0,3,248,0,0,255,255,254,254,253,250,248,245,224,234,208,165,139,87,6,172,13,89,27,179,53,101,237,117,179,27,93,44,134,86,23,139,229,210,233,244,250,253,254,255,255,1,253,253,13,149,21,21,21,13,13,13,45,45,45,45,45,45,45,45,45,45,45,45,45,13,13,45,45,93,85,53,165,165,101,197,133,133,5,5,5,5,5,5,5,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,5,5,5,5,5,133,197,101,181,93,45,45,21,21,5,5,37,13,253,5,5,5,253,1,255
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,12,255,255,1,0,128,1,0,128,1,0,128,1,136,128,0,128,128,0,98,128,0,64,128,0,128,128,1,0,128,2,0,128,6,0,128,4,0,128,8,128,128,16,0,128,32,0,128,96,0,128,64,0,128,200,0,128,128,0,129,16,0,131,0,0,130,0,0,0,134,64,0,132,0,0,132,128,0,140,128,0,136,0,0,145,0,0,176,0,0,160,0,0,196,0,0,192,0,0,128,0,0,16,0,0,0,0,0,0,0,0,64,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,0,0,255,128,0,0,0,254,0,0,131,226,0,128,96,0,128,64,0,128,136,0,129,0,0,131,0,0,130,0,0,132,64,0,140,0,0,136,0,0,145,0,0,176,0,0,160,0,0,0,228,0,0,192,0,0,200,0,0,200,0,0,200,0,0,128,0,0,144,0,0,0,0,0,32,0,0,32,0,0,0,0,0,143,255,255,128,0,0,224,0,0,191,255,255,255,255,255,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,252,0,0,7,255,255,0,120,0,0,0,7,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,97,0,0,98,0,64,98,0,160,97,0,65,34,1,10,64,0,0,0,0,0,0,0,0,0,0,0,0,0,16,16,20,64,65,4,64,78,28,64,68,4,64,80,136,64,89,0,0,0,0,0,0,0,0,0,0,0,0,0,128,48,2,8,50,2,112,56,0,32,56,2,132,146,2,201,32,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,24,0,32,4,0,64,2,0,128,1,0,128,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,1,0,128,1,0,64,2,0,32,4,0,0,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,192,0,0,7,255,255,248,0,0,15,255,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,0,0,0,3,255,255,80,0,0,193,85,85,0,255,252,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,3,192,255,255,195,255,207,195,255,207,192,255,63,195,255,3,63,255,255,255,255,255,255,0,255,255,255,255,255,255,3,12,252,255,252,252,255,252,48,255,255,240,255,240,60,255,243,60,255,255,255,255,255,255,255,255,255,255,255,255,63,255,63,243,252,255,195,243,240,207,243,255,195,60,255,255,15,63,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,131,255,250,171,255,202,168,255,234,168,255,234,170,255,42,170,255,42,170,255,170,170,255,170,170,255,42,170,255,42,170,255,234,170,255,234,170,255,202,168,255,250,171,255,240,131,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,64,63,255,213,84,0,0,3,85,255,252,0,85,87,255,255,255,255,0,0,0,85,85,85,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,31,255,255,240,0,0,15,0,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,1,128,0,1,0,0,2,0,0,1,0,0,5,0,0,11,0,0,6,148,0,20,4,0,44,156,0,40,4,0,88,8,0,176,0,0,96,0,1,65,0,2,195,0,2,135,0,0,5,133,0,13,13,0,11,9,0,10,25,0,22,21,0,44,53,0,40,37,0,12,21,0,22,25,0,11,9,0,5,5,0,5,135,0,2,195,0,1,67,0,1,65,0,0,96,0,0,48,0,0,88,0,0,44,0,0,22,0,0,11,0,0,0,5,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,240,0,0,15,255,255,248,0,0,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,128,0,0,191,255,255,160,0,6,160,0,5,160,0,4,160,0,5,161,255,134,0,161,0,195,161,127,64,161,66,193,161,68,131,161,69,6,161,75,13,161,86,26,161,108,20,161,72,52,161,80,104,161,48,208,161,33,160,161,97,64,161,67,64,161,130,128,161,134,0,161,13,0,161,10,0,160,26,0,160,20,0,160,20,0,0,160,48,0,160,40,0,160,96,0,160,208,0,160,160,0,161,128,0,163,64,0,162,128,0,166,128,0,173,0,0,170,0,0,184,0,0,180,0,0,176,0,0,168,0,0,144,0,0,144,0,0,160,0,0,192,0,0,192,0,0,128,0,0,0,255,0,0,128,24,28,191,224,4,160,63,232,160,0,80,160,0,208,160,1,160,161,193,64,161,131,0,161,134,128,161,13,0,160,10,0,160,26,0,160,52,0,160,40,0,160,104,0,160,208,0,160,160,0,161,160,0,161,64,0,161,64,0,0,161,64,0,163,0,0,162,128,0,166,128,0,165,0,0,165,0,0,164,0,0,164,127,255,166,0,0,163,255,255,160,0,0,160,0,0,160,0,0,160,0,0,191,255,255,128,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,0,0,1,255,252,1,0,3,93,85,84,61,63,255,245,255,255,245,0,255,255,253,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,245,255,255,253,0,255,255,209,255,255,253,255,255,221,255,255,221,255,255,253,255,255,205,255,255,125,255,255,253,255,255,29,255,253,253,191,255,125,191,244,125,191,255,253,191,253,253,191,241,253,191,221,253,255,247,253,255,71,61,255,247,61,255,87,253,252,220,253,0,253,31,253,255,223,253,255,95,253,252,115,253,247,127,253,244,127,253,255,223,253,255,31,253,255,223,253,255,119,61,255,199,61,255,247,61,255,215,253,255,221,253,255,241,253,255,255,253,255,252,125,255,255,253,255,255,61,255,255,253,255,255,205,0,255,255,253,255,255,241,255,255,253,255,255,245,255,255,253,255,255,245,255,255,253,255,255,253,255,255,253,85,85,93,0,0,1,255,255,253,85,85,93,255,255,253,0,0,1,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,64,0,0,127,255,243,117,85,124,127,255,255,127,255,255,124,0,211,127,255,252,127,3,247,127,3,252,0,127,47,255,127,15,243,127,15,255,127,51,79,127,63,255,127,255,223,127,255,63,127,255,255,127,244,255,127,63,255,127,245,255,124,255,255,124,243,255,127,223,255,127,255,255,127,71,255,127,255,255,127,223,255,127,95,255,127,255,255,127,63,255,0,125,255,255,127,255,255,124,255,255,119,255,255,127,255,255,113,255,255,127,255,255,127,255,254,79,255,255,127,255,255,95,255,255,127,255,255,127,255,255,127,255,255,127,255,255,255,255,255,255,255,255,255,255,255,3,255,255,85,79,207,64,53,95,0,127,192,63,117,127,255,127,215,127,127,244,255,124,255,255,124,253,255,124,243,255,127,223,255,127,255,255,127,199,255,127,127,255,127,255,255,127,31,255,125,255,255,127,255,255,116,127,255,127,255,255,125,255,255,125,255,255,117,255,255,127,255,255,0,113,255,255,127,255,255,119,255,255,119,255,255,127,0,0,115,85,85,124,0,0,119,255,255,125,85,85,117,85,85,127,255,255,64,0,0,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,0,0,0,252,255,255,117,192,0,255,85,85,255,252,0,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,207,63,255,255,63,255,255,63,255,207,63,255,207,63,255,202,191,255,255,255,255,255,255,255,255,255,255,255,255,252,203,139,255,251,131,255,251,131,0,255,255,131,255,243,131,255,254,139,255,255,255,255,255,255,255,255,255,255,255,255,243,250,131,242,255,176,243,191,178,240,255,178,240,255,176,243,234,178,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127,255,255,0,255,240,255,255,240,255,127,240,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,192,63,255,240,255,255,240,255,255,240,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,15,255,255,84,63,255,1,84,1,252,5,87,87,240,3,85,95,253,255,255,255,0,0,0,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
