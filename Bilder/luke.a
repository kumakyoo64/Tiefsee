!to "luke.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 24
CHAR_COL1   !by 14
CHAR_COL2   !by 12
SPRITE_POS  !by 95,42,70,42,95,43,34,43,69,45,95,45,32,48,71,48,0
SPRITE_COL  !by 11,14,1,0,12,12,11,15,0,6
SPRITE_BG   !by 205
SPRITE_MC   !by 232
SPRITE_XS   !by 200

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B15E

CHAR        !by 128,139,150,161,172,183,193,204,215,225,235,129,140,151,162,173,173,194,205,173,173,236,130,141,152,163,174,184,195,206,216,226,237,131,142,153,164,175,185,196,207,217,227,238,132,143,154,165,176,186,197,208,218,228,239,133,144,155,166,177,187,198,209,219,229,240,134,145,156,167,178,188,199,210,220,230,241,135,146,157,168,179,189,200,211,221,231,242,136,147,158,169,180,190,201,212,222,232,243,137,148,159,170,181,191,202,213,223,233,244,138,149,160,171,182,192,203,214,224,234,245
CHAR_COL    !by 6,14,14,14,14,8,14,8,6,6,6,14,8,8,8,0,0,8,8,0,0,6,6,14,14,14,14,8,14,8,6,6,6,6,6,6,6,6,6,6,6,14,14,14,6,6,6,6,6,6,6,6,6,1,1,6,6,6,6,6,6,6,6,6,6,14,6,6,6,6,6,6,6,6,14,14,14,6,6,6,6,6,6,6,6,14,14,14,6,6,6,6,6,6,6,6,14,14,14,6,6,6,6,6,6,6,6,14,14,14,6,6,6,6,6,6,6,6,14,14,14
CHAR_DATA   !by 255,253,255,223,255,254,248,224,200,200,0,0,0,0,200,200,224,248,254,255,239,187,191,231,3,0,16,25,16,56,49,39,0,4,190,125,63,4,15,22,199,221,255,196,9,239,126,131,98,44,115,169,242,185,189,44,199,131,248,24,7,134,189,247,55,225,249,255,99,103,103,131,231,242,242,64,64,6,129,128,176,33,16,18,130,0,129,9,255,255,255,252,200,0,128,10,32,0,0,32,0,0,0,8,0,128,0,192,252,255,255,255,16,153,57,240,80,178,24,137,13,55,242,245,219,204,249,255,152,220,254,239,109,247,111,28,195,213,89,221,136,192,102,22,36,194,22,28,64,123,120,4,231,253,61,62,183,229,197,86,4,0,68,102,102,128,8,20,20,128,131,3,16,0,0,12,255,255,200,128,128,0,0,128,0,2,0,0,2,0,0,128,0,0,32,32,128,192,255,255,0,0,138,2,68,4,176,0,34,52,96,130,252,248,176,251,246,23,248,218,223,253,231,4,10,14,118,244,97,248,20,8,128,28,56,28,26,192,12,121,89,209,130,227,125,151,57,54,12,40,224,0,0,0,0,12,3,0,20,0,0,96,0,9,255,8,0,0,0,0,0,0,0,8,8,8,8,32,0,0,0,0,0,128,2,0,8,255,0,28,68,136,0,32,0,0,0,32,17,1,0,48,57,48,0,128,63,53,183,52,2,52,36,4,76,8,4,56,0,4,0,0,63,0,0,0,0,7,14,42,34,6,15,40,32,0,0,63,39,47,32,32,33,36,60,36,32,32,56,48,31,0,194,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,168,0,0,240,0,64,0,0,1,32,0,16,0,8,128,0,16,20,32,32,0,0,255,227,227,64,25,81,153,17,48,114,34,0,2,0,0,0,255,3,6,32,134,194,0,0,72,41,153,196,114,0,0,255,33,6,2,204,14,4,144,0,98,131,39,113,255,0,2,0,128,128,0,0,0,0,0,0,0,0,0,2,0,58,0,64,0,0,4,4,2,96,0,64,64,3,66,0,150,133,0,0,255,36,124,108,203,251,1,161,196,97,59,7,194,1,0,0,255,131,16,0,12,4,8,32,56,32,130,52,4,2,0,252,153,65,36,48,65,6,198,0,0,216,129,128,255,0,3,42,42,8,42,42,42,42,42,42,42,42,42,42,0,2,42,42,42,42,138,138,42,3,3,4,0,0,136,8,4,2,32,130,7,3,0,19,55,24,0,0,247,45,101,20,206,31,219,26,92,4,20,135,3,3,0,0,244,6,1,1,0,136,0,0,0,96,0,0,48,95,0,128,48,24,18,2,0,4,4,6,0,192,128,3,255,0,0,160,170,170,170,170,170,170,170,162,128,128,160,10,42,170,170,170,170,170,170,170,160,0,65,20,51,67,143,135,1,71,79,71,1,1,11,3,192,201,15,15,128,134,128,71,199,142,135,138,195,69,65,202,4,0,0,1,0,192,68,192,64,64,68,202,66,68,8,0,64,129,1,0,72,0,64,64,72,65,64,64,64,64,64,69,192,0,255,255,3,0,0,0,0,0,0,0,0,0,0,0,254,255,213,119,117,5,112,64,84,12,224,136,200,216,240,176,72,216,216,255,255,231,247,239,238,109,67,245,220,119,61,220,215,245,85,87,93,245,85,85,215,85,85,125,213,93,87,125,93,87,85,87,85,117,87,85,117,93,93,93,93,125,93,119,85,85,255,255,255,55,3,0,0,0,0,0,0,3,63,255,255,255,95,93,93,221,55,0,0,0,142,201,255,255,127,1,4,81,0,193,242,240,151,230,254,177,221,240,192,117,215,7,221,125,93,127,213,85,93,79,127,117,85,85,215,87,117,85,213,85,119,87,87,87,117,125,125,67,67,253,127,125,213,221,93,125,255,187,223,239,255,252,63,15,3,1,1,0,1,1,1,3,15,31,255,255,223,219,223,255,119,87,215,223,253,0,0,0,149,147,255,255,119,64,16,68,0,13,221,253,55,245,243,3,205,125,127,115,93,13,247,115,85,95,213,85,117,213,81,113,119,119,117,119,85,93,125,93,193,77,7,119,119,119,247,193,125,253,7,67,193,243,255,247
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,228,72,1,196,202,1,199,74,1,228,201,1,255,255,1,255,255,1,191,187,1,128,160,1,130,8,1,168,162,1,255,255,0,0,0,0,1,36,0,0,0,0,8,0,0,0,80,0,0,0,0,0,0,128,0,2,0,0,0,0,32,0,10,144,136,8,128,64,0,36,0,4,32,4,64,8,0,0,0,4,0,129,18,128,2,32,32,72,0,0,0,0,16,0,0,0,64,148,128,0,8,0,0,0,8,0,0,8,32,32,128,4,0,0,0,0,136,0,0,0,0,2,32,0,129,0,0,128,8,0,1,0,128,0,0,0,16,0,16,0,128,0,0,0,16,16,0,72,130,1,0,4,1,0,0,32,0,2,0,128,10,0,0,2,0,64,144,162,72,0,2,0,0,18,72,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,1,0,0,7,0,0,12,0,0,24,0,0,8,0,0,8,0,0,12,0,0,12,0,0,8,0,0,8,0,0,28,0,0,8,0,0,8,0,0,8,223,223,248,255,255,248,0,0,28,0,0,12,0,0,8,0,0,12,0,0,12,0,0,0,8,0,0,8,0,0,12,0,0,12,0,0,12,0,0,8,0,0,8,0,0,12,0,0,8,255,241,28,255,255,248,0,0,24,0,0,8,0,0,8,0,0,8,0,0,8,0,0,8,0,0,8,0,0,13,0,0,15,0,0,14,0,0,0,12,0,0,12,0,0,12,210,0,12,255,255,252,0,7,252,0,0,8,0,0,12,0,0,12,0,0,8,0,0,12,0,0,12,0,0,8,0,0,12,0,0,8,0,0,8,0,0,12,0,0,8,0,0,12,255,255,252,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,16,225,0,0,255,24,0,255,225,0,148,228,64,0,231,239,144,255,255,196,255,204,241,255,200,248,127,255,252,63,255,252,255,240,28,255,240,60,255,255,248,255,255,241,254,99,228,255,255,128,255,254,64,157,241,0,254,16,0,224,0,32,64,64,0,0,0,0,0,5,8,17,4,0,144,2,96,0,0,66,68,144,25,84,130,0,0,0,19,34,4,18,5,0,0,133,4,0,48,36,0,0,32,0,0,8,0,4,24,90,84,36,64,85,32,0,0,32,0,0,0,32,2,64,8,0,64,8,0,72,0,8,4,0,0,4,64,8,6,24,0,0,128,0,68,8,0,18,132,64,0,0,0,0,0,1,132,0,1,128,0,0,24,96,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,2,0,0,0,0,0,0,16,0,0,1,0,0,0,0,0,24,0,1,153,0,0,0,0,0,0,6,0,0,18,0,0,4,0,0,0,0,0,2,0,1,128,0,1,129,0,24,25,0,0,0,0,0,1,0,0,64,0,0,0,6,0,0,0,0,1,0,0,0,0,96,0,0,0,0,0,0,96,0,0,1,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,68,0,22,170,5,106,74,69,170,90,5,154,170,26,170,170,0,90,170,170,101,170,170,102,170,170,106,150,170,170,150,170,166,150,170,170,150,170,170,165,170,106,169,85,101,170,85,106,170,170,90,170,170,26,90,170,6,90,170,1,169,41,68,106,168,0,22,170,0,0,80,255,255,255,255,255,255,255,243,255,0,255,195,255,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,63,207,255,63,207,255,12,15,255,255,207,255,207,207,255,240,207,255,255,192,17,255,192,0,3,192,0,252,207,255,255,204,243,204,15,255,60,207,252,255,207,255,0,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,63,207,255,255,207,255,255,192,0,207,192,0,255,192,0,255,207,255,255,207,255,252,207,255,63,207,255,255,204,255,207,207,255,243,207,255,243,195,255,51,195,255,255,7,255,0,207,207,255,207,207,255,255,192,21,255,192,0,255,192,1,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,255,207,255,255,195,255,255,207,255,255,207,255,255,207,207,255,207,255,255,207,255,255,196,0,255,192,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,222,223,128,0,0,3,113,0,0,96,6,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,7,0,0,7,0,0,3,0,0,63,255,255,252,255,255,192,0,0,0,0,0,0,0,0,0,0,0,3,128,103,0,0,46,0,4,0,3,251,63,128,0,0,0,0,0,0,0,0,1,0,0,4,0,0,8,0,0,0,2,0,0,10,0,0,2,0,0,0,0,0,0,0,0,10,0,0,10,0,0,0,0,0,10,0,0,2,0,0,2,16,16,2,0,0,2,0,1,0,0,0,8,0,0,10,0,0,0,0,0,0,0,0,10,0,0,10,0,0,8,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,8,0,0,10,0,7,112,0,0,2,0,1,114,0,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,8,0,0,8,0,0,0,0,22,180,8,0,0,0,0,108,0,0,0,2,0,0,8,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,16,21,0,0,0,84,0,0,17,0,89,17,64,20,16,80,0,0,20,0,0,17,5,0,21,5,64,0,1,64,0,1,0,6,81,0,5,65,0,0,5,0,0,5,1,84,20,0,0,80,0,1,64,81,5,0,0,80,0,21,0,16,64,64,0,0,0,0,63,255,255,255,255,255,255,255,255,15,255,255,240,63,255,0,242,170,170,254,8,170,14,42,32,14,40,32,62,42,10,62,0,0,50,0,0,14,128,128,62,42,10,254,42,162,50,170,170,50,0,0,0,63,3,192,15,255,204,15,195,204,60,15,12,12,255,12,192,204,207,63,192,240,63,204,207,192,243,0,252,192,255,255,255,252,195,255,252,255,15,207,255,63,255,255,243,243,255,255,255,255,255,252,255,255,255,255,255,255,255,255,255,255,243,63,255,255,252,255,255,240,255,255,255,243,255,255,255,255,255,255,255,255,255,255,255,243,255,255,255,255,243,0,255,255,252,255,255,48,255,255,243,255,255,207,255,255,255,255,255,255,255,243,255,255,243,255,255,243,192,255,243,243,255,243,195,255,243,207,255,243,240,255,255,240,255,255,252,255,255,243,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,32,20,2,1,80,85,65,0,80,5,84,0,20,16,0,16,0,0,85,64,0,85,0,0,64,20,0,64,21,0,0,85,20,0,64,21,0,64,5,64,64,1,85,85,64,85,80,0,0,16,0,0,21,84,0,5,16,0,129,65,81,145,80,1,64,5,4,160,0,85,255,255,255,255,255,255,255,249,255,243,251,255,255,251,255,255,251,255,255,251,255,255,251,255,0,255,251,255,255,251,255,243,251,255,243,247,255,207,55,255,255,55,255,195,247,255,240,59,255,255,58,170,255,250,170,3,52,0,252,247,255,255,203,255,195,59,255,252,251,255,255,251,243,255,251,255,255,251,255,255,251,255,255,59,255,63,251,255,0,255,59,255,255,251,255,255,251,255,255,250,170,255,250,170,63,248,0,255,251,255,255,251,255,255,251,255,255,251,255,63,251,255,255,251,255,243,251,255,63,250,255,15,250,255,255,248,255,255,251,255,255,251,255,255,250,165,255,250,170,63,248,1,0,63,251,255,255,248,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,251,255,255,248,0,255,250,170,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,170,170,0,26,168,80,5,162,69,64,104,0,0,74,0,5,72,0,5,70,0,0,6,0,0,81,0,16,81,0,84,1,0,0,84,1,0,16,21,0,80,21,85,64,1,85,0,1,0,1,86,0,0,6,0,0,26,0,21,26,21,0,98,5,5,40,64,26,162,85,170,170,255,255,255,255,255,255,255,239,255,255,235,255,255,238,191,255,254,0,255,255,0,255,251,0,0,255,235,0,255,255,0,255,251,0,255,250,0,255,251,0,255,251,0,239,191,0,255,250,0,68,42,0,0,42,186,170,186,191,255,187,191,175,186,235,255,250,191,191,250,174,174,175,186,255,190,250,191,255,238,255,254,175,255,255,254,239,251,254,0,255,191,187,255,255,255,255,255,254,5,127,255,0,63,255,169,127,255,255,255,255,255,255,255,255,191,239,255,255,254,255,255,254,255,255,255,255,239,255,255,239,255,255,255,255,255,255,255,255,255,255,255,255,254,86,191,254,0,63,254,164,63,254,0,255,255,251,255,255,255,255,255,255,255,255,255,255,255,255,255,255,234,255,255,239,255,255,255,255,255,251,191,255,254,255,255,254,255,255,254,170,191,255,0,63,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
