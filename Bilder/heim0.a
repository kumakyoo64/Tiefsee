!to "heim0.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 12
CHAR_COL2   !by 14
SPRITE_POS  !by 39,42,95,42,32,43,71,43,47,45,34,45,95,48,32,48,0
SPRITE_COL  !by 11,15,12,6,6,15,12,12,12,3
SPRITE_BG   !by 209
SPRITE_MC   !by 241
SPRITE_XS   !by 16

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B1BE

CHAR        !by 128,139,150,161,169,178,185,195,205,215,225,129,140,151,162,170,155,186,196,206,216,226,130,141,152,163,171,179,187,197,207,179,227,131,142,153,164,172,180,188,198,177,217,228,132,143,154,165,173,181,189,199,208,218,155,133,144,155,155,174,155,190,155,209,219,229,134,145,156,166,155,167,191,200,210,220,155,135,146,157,155,175,182,155,201,211,221,230,136,147,158,155,176,183,192,202,212,222,231,137,148,159,167,155,155,193,203,213,223,232,138,149,160,168,177,184,194,204,214,224,233
CHAR_COL    !by 14,14,12,11,12,12,12,12,12,14,14,14,12,12,12,12,12,12,12,12,12,14,12,12,12,12,12,12,12,12,12,12,6,12,11,1,1,1,1,1,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,1,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,6,14,12,12,12,12,12,12,12,12,12,14,14,14,12,12,12,12,12,12,12,14,14
CHAR_DATA   !by 1,1,131,199,255,255,255,255,254,252,248,240,224,192,192,128,15,31,63,63,127,127,255,255,246,254,254,254,252,252,252,236,252,254,243,253,255,189,255,255,255,251,255,255,255,255,191,255,247,255,255,255,255,247,255,247,255,255,255,253,255,191,127,255,255,255,119,119,63,62,31,15,128,192,192,224,240,120,60,62,63,127,255,255,255,255,255,255,255,254,248,240,224,192,128,0,62,127,255,255,255,255,255,255,255,255,255,255,255,255,255,63,128,241,248,248,255,255,255,249,30,126,254,255,255,255,255,255,127,255,255,255,255,255,253,255,255,255,190,253,255,255,255,255,255,255,255,253,255,255,253,255,223,255,183,255,255,255,255,255,255,255,255,255,255,255,127,63,0,128,192,224,240,248,254,255,3,15,55,127,255,255,255,255,191,255,255,255,255,255,239,255,255,247,255,255,255,191,255,255,0,7,0,0,0,0,0,0,0,7,31,255,255,255,254,255,255,255,255,255,255,255,255,255,255,255,250,255,255,191,255,255,255,255,253,255,255,255,255,255,119,255,239,255,255,253,255,255,191,255,255,255,255,255,255,127,255,253,255,255,127,63,15,3,0,0,0,0,0,0,0,8,127,255,251,255,247,255,127,255,255,255,255,255,255,255,255,224,0,199,5,0,0,0,0,0,0,0,135,255,255,255,253,255,239,255,255,221,255,255,255,223,239,255,255,255,255,255,255,255,255,255,239,255,255,255,255,255,255,255,255,255,255,251,254,255,255,127,255,63,239,255,255,255,255,255,255,254,255,255,255,255,112,255,127,0,0,0,0,0,0,1,15,255,239,255,255,255,255,255,254,255,255,255,255,191,255,255,255,255,255,247,223,255,255,251,255,255,255,255,255,255,255,255,255,255,254,255,255,255,223,255,255,255,255,255,255,255,253,255,255,255,255,255,255,255,0,224,248,33,0,0,0,0,96,0,0,0,0,0,0,0,255,255,255,247,255,253,255,255,255,223,255,255,255,251,255,255,239,255,255,255,255,247,239,127,127,255,191,239,255,255,255,255,255,255,255,255,255,255,251,255,255,239,255,255,254,63,255,255,0,0,0,128,48,8,0,0,255,223,255,255,255,255,255,239,255,255,255,255,255,255,255,245,127,16,0,0,48,115,255,255,247,255,255,255,255,255,255,255,255,255,255,191,255,255,253,255,255,239,255,255,255,255,255,255,255,255,255,251,255,255,255,255,127,191,255,255,255,251,255,255,223,247,255,255,255,111,255,255,255,255,255,255,255,253,255,255,255,254,255,255,251,255,191,255,0,159,0,0,0,0,0,0,255,255,255,255,239,255,255,223,255,255,255,255,239,255,255,255,255,255,251,255,255,255,254,255,253,223,239,255,255,255,255,255,224,248,254,255,255,255,175,255,255,255,253,255,255,254,255,255,255,255,255,255,255,255,255,191,255,254,255,255,255,255,255,255,255,255,255,255,223,239,255,255,0,224,4,0,0,0,0,0,255,255,247,255,254,255,255,255,255,255,255,255,127,255,255,255,247,255,251,254,255,255,255,255,239,255,255,255,254,252,240,192,255,127,31,15,7,3,1,0,252,254,255,247,255,255,255,255,255,255,255,255,255,255,247,253,255,255,255,247,255,255,255,255,255,254,255,127,255,255,223,255,255,255,251,253,251,255,255,255,255,255,255,255,223,255,255,255,255,255,255,127,255,255,255,255,127,255,255,255,255,255,254,252,0,1,3,7,15,31,127,255,7,143,255,255,255,255,255,255,127,63,31,15,7,3,3,1,6,7,3,3,1,1,0,0,255,255,255,255,190,255,255,255,255,255,255,223,255,255,255,255,254,207,255,255,255,255,255,255,0,0,1,1,3,3,7,14,1,3,3,7,15,31,63,127,255,255,255,248,240,224,224,224
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,0,2,170,0,14,170,0,42,170,0,170,170,0,0,170,170,2,170,170,10,170,174,11,250,106,42,170,170,42,170,171,170,170,170,170,170,174,170,170,170,170,174,106,170,170,170,170,170,170,170,174,170,170,170,170,170,170,170,170,170,170,170,186,170,170,170,170,122,170,175,74,170,181,90,88,60,0,92,255,255,95,213,63,85,85,85,85,85,85,85,85,85,86,85,85,95,65,85,123,66,85,171,74,182,234,170,170,170,170,170,234,170,170,170,170,233,170,170,170,122,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,171,170,170,0,170,170,170,170,170,166,170,170,170,251,233,106,169,170,153,170,170,170,170,186,170,170,170,170,170,170,154,170,170,170,170,170,170,170,171,170,235,170,170,170,170,170,170,170,170,169,170,170,170,170,170,158,102,170,170,170,170,223,174,170,170,170,170,0,170,170,170,234,171,170,170,170,170,170,170,170,170,186,166,170,170,170,170,170,170,170,170,170,170,170,170,42,170,170,42,170,170,10,234,170,10,170,170,2,171,170,0,170,166,0,170,170,0,42,170,0,10,170,0,2,170,0,0,170,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,120,3,128,56,0,224,0,0,112,0,0,56,0,0,0,12,0,0,6,0,0,3,0,0,1,128,0,0,192,0,0,96,0,0,48,0,0,24,0,0,28,0,0,14,0,0,6,0,0,3,0,0,3,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,3,0,0,7,0,0,6,0,0,14,0,0,28,0,0,24,0,0,48,0,0,96,0,0,192,0,1,128,0,3,0,0,6,0,0,28,0,0,56,0,0,240,3,1,224,15,7,128,15,31,0,15,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,124,124,0,240,56,3,192,48,7,128,0,14,0,0,28,0,0,0,48,0,0,96,0,0,192,0,1,128,0,3,0,0,6,0,0,12,0,0,28,0,0,56,0,0,48,0,0,112,0,0,224,0,0,192,0,0,192,0,0,128,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,128,0,0,192,0,0,0,192,0,0,224,0,0,112,0,0,48,0,0,56,0,0,28,0,0,12,0,0,6,0,0,3,0,0,193,128,0,192,192,0,128,96,0,0,48,0,0,28,0,0,14,0,0,7,128,0,3,192,0,0,240,0,0,124,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,8,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,16,0,0,4,0,0,0,0,0,0,0,0,128,0,32,8,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,239,0,0,255,224,0,8,120,1,0,128,0,0,0,0,0,0,0,0,16,0,0,0,0,0,128,0,0,0,2,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,8,64,28,0,3,176,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,8,1,0,0,0,0,0,0,0,16,0,4,0,16,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,4,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,166,106,42,170,170,170,170,170,170,170,169,170,170,170,170,186,170,170,170,170,170,170,170,0,234,170,166,170,106,166,170,170,170,170,234,170,170,154,170,170,170,170,170,170,170,170,170,170,170,169,170,170,170,154,170,170,170,170,166,170,170,170,170,170,170,102,170,170,170,171,234,170,169,234,170,127,2,170,255,194,170,211,255,170,85,95,234,0,85,85,106,85,85,106,85,85,106,5,85,106,5,90,170,41,90,170,170,170,170,170,154,170,170,170,170,170,170,166,170,170,170,170,170,170,170,170,170,170,166,170,170,170,170,170,170,170,170,170,170,170,170,170,170,106,154,170,170,170,170,170,92,0,170,170,87,170,170,85,170,170,85,170,170,85,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,154,170,170,106,170,170,170,170,170,170,170,170,154,170,170,170,170,170,170,170,170,170,169,170,170,170,170,170,170,0,170,170,170,170,170,170,170,170,170,170,170,169,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,169,169,170,170,150,170,170,170,170,170,170,170,166,170,170,170,170,42,169,170,42,170,170,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,42,0,0,186,0,2,170,0,10,170,0,10,170,0,42,170,0,170,170,0,0,175,169,2,170,170,2,170,170,10,170,170,10,170,170,10,170,170,42,170,233,42,170,170,42,170,170,170,170,186,170,170,170,170,170,170,170,170,170,170,171,170,170,170,170,171,170,170,139,170,170,169,101,96,169,123,255,169,127,87,165,85,85,0,165,85,85,165,85,85,37,85,85,173,100,21,169,164,9,154,164,43,166,170,170,170,170,170,166,170,170,170,170,174,170,170,170,169,170,170,138,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,174,170,170,170,170,138,170,170,170,170,170,0,171,174,150,170,166,170,170,170,170,138,171,170,170,170,170,138,170,170,170,170,170,170,170,170,170,170,174,174,174,170,170,170,170,170,170,170,170,166,170,170,170,170,170,105,154,170,170,170,137,186,234,138,170,170,170,170,170,170,170,174,170,170,170,0,42,170,170,42,171,170,42,170,170,10,170,170,10,170,170,10,170,170,2,170,170,2,170,170,0,171,170,0,170,170,0,42,174,0,10,170,0,10,170,0,2,170,0,0,170,0,0,42,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,0,0,168,0,0,170,0,0,170,128,0,170,128,0,170,160,0,158,168,0,170,168,0,170,170,0,170,170,0,169,170,128,0,170,174,128,170,170,160,170,106,144,170,170,160,170,170,168,170,169,168,170,170,168,170,170,170,170,170,170,170,170,174,170,170,170,170,170,170,186,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,234,186,170,170,170,170,166,170,170,171,170,0,170,170,170,106,234,170,170,170,170,170,166,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,234,170,170,170,170,234,186,154,170,170,166,170,170,170,154,170,170,170,170,170,170,170,10,170,170,254,171,170,87,171,170,86,169,170,0,106,170,170,170,170,170,170,170,170,170,170,170,170,170,158,166,170,170,170,170,170,170,122,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,171,170,170,170,170,106,170,106,170,170,170,170,170,170,170,168,170,170,168,174,234,168,170,170,160,0,171,170,160,170,234,160,170,170,128,170,170,128,106,170,0,170,170,0,174,168,0,170,168,0,170,160,0,170,128,0,170,0,0,170,0,0,168,0,0,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,128,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,192,0,0,0,0,192,0,13,192,0,1,81,80,1,95,255,1,95,213,1,85,85,1,85,85,1,85,85,49,85,85,0,3,81,5,1,65,0,4,1,0,1,0,0,0,0,0,193,0,0,0,0,3,0,0,0,0,64,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,3,0,0,0,0,12,0,0,0,0,0,0,195,5,0,1,0,0,0,0,0,12,0,192,0,0,0,4,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,192,0,0,64,1,0,0,0,0,0,16,68,0,0,0,4,76,48,12,0,0,0,0,0,3,0,3,0,0,0,0,0,0,0,0,192,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,192,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
