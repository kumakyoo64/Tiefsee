!to "kommando.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 24
CHAR_COL1   !by 12
CHAR_COL2   !by 15
SPRITE_POS  !by 33,42,69,42,71,43,95,43,71,45,34,45,32,48,69,48,0
SPRITE_COL  !by 14,15,12,1,12,12,11,12,11,11
SPRITE_BG   !by 81
SPRITE_MC   !by 210
SPRITE_XS   !by 241

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B1EE

CHAR        !by 128,139,139,139,159,169,179,190,201,210,217,129,140,147,153,160,170,180,191,202,211,218,130,141,148,131,161,171,181,192,203,212,219,131,131,131,131,161,170,182,193,204,213,220,132,132,132,132,162,172,183,194,205,214,221,133,142,142,142,163,173,184,195,206,215,222,134,143,149,154,164,174,185,196,207,207,223,135,144,150,155,165,175,186,197,146,146,224,136,145,151,156,166,176,187,198,208,146,225,137,146,146,157,167,177,188,199,146,146,226,138,139,152,158,168,178,189,200,209,216,227
CHAR_COL    !by 8,0,0,0,8,8,14,6,8,8,8,6,6,6,6,6,8,8,6,8,8,8,6,6,6,6,6,8,11,6,9,9,9,6,6,6,6,6,8,11,6,6,14,14,6,6,6,6,14,8,8,11,3,6,6,9,1,1,1,9,9,8,9,9,1,9,14,14,14,14,14,14,14,14,14,14,14,9,8,8,8,8,8,8,8,0,0,8,9,8,8,8,10,10,10,8,8,0,9,8,0,0,8,10,10,10,8,0,0,9,9,1,9,1,9,8,8,8,8,9,9
CHAR_DATA   !by 0,0,64,0,0,0,0,0,0,255,194,255,34,255,31,0,255,1,7,31,127,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,64,64,0,255,0,0,255,255,64,64,0,0,0,128,128,32,43,2,226,32,0,0,0,0,0,0,0,0,0,2,226,40,0,0,0,0,0,0,0,0,0,0,64,255,0,0,64,0,0,0,0,255,0,0,0,0,255,1,255,6,255,255,23,255,16,255,255,255,255,255,255,0,0,0,0,255,0,0,255,255,0,0,0,2,0,136,170,34,168,128,128,0,0,0,0,0,0,0,0,0,10,128,0,0,0,0,0,0,0,0,0,0,255,32,255,16,255,255,255,255,63,255,255,255,255,255,255,255,0,0,0,32,128,170,32,0,0,0,0,8,0,0,0,130,138,136,0,0,0,0,0,0,0,0,43,240,0,0,0,0,255,144,255,65,255,255,255,255,0,0,0,40,0,0,0,0,0,2,0,42,162,170,0,136,10,162,0,0,0,2,0,2,2,2,0,0,0,0,0,0,0,0,255,0,0,0,0,2,2,0,2,0,0,0,0,0,248,248,248,8,248,248,248,248,248,248,248,248,248,248,248,252,0,0,0,0,0,0,2,2,0,0,2,255,2,2,255,255,0,0,2,2,2,2,2,2,166,154,2,10,138,136,2,162,32,10,2,8,143,191,255,191,159,128,0,128,8,2,2,2,2,2,254,8,2,2,0,170,170,0,160,32,226,226,226,226,226,226,226,226,226,226,226,226,226,224,224,224,224,224,226,226,226,226,226,226,226,34,162,171,11,35,172,254,138,170,255,255,0,0,170,170,170,170,170,170,138,42,170,42,8,8,170,168,40,168,170,60,255,255,255,255,255,255,0,0,0,170,170,170,170,170,42,0,170,170,0,160,160,128,163,131,128,128,128,128,128,128,128,128,128,128,128,195,192,128,128,160,176,160,176,160,12,8,172,170,19,19,170,164,134,169,161,170,168,42,18,8,176,130,128,21,170,170,0,255,21,21,170,170,170,170,170,170,26,20,170,34,26,154,170,132,18,134,170,10,244,254,255,254,254,214,22,2,10,170,170,170,170,170,170,21,170,170,21,7,14,14,28,28,24,56,56,48,48,48,48,48,48,48,48,56,56,24,28,28,14,14,7,7,3,1,0,0,4,6,0,192,48,48,172,64,107,136,164,197,241,176,140,67,160,160,255,255,85,85,160,160,160,160,160,160,160,160,160,41,10,132,160,144,150,20,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,85,160,160,85,0,0,0,0,4,0,0,1,0,0,1,21,20,0,0,0,0,0,0,16,0,1,74,31,128,192,224,240,120,62,31,7,0,0,0,0,0,0,64,16,56,44,80,17,5,192,60,255,255,85,85,0,0,0,0,0,68,16,68,0,0,0,0,0,0,0,0,0,85,0,0,85,0,0,0,0,0,0,0,64,0,0,0,84,64,0,0,0,1,80,0,1,21,0,255,254,0,4,85,85,20,85,213,245,255,63,0,64,96,0,0,0,0,0,128,0,0,0,0,255,0,0,0,255,0,0,0,85,2,2,2,2,2,2,2,6,1,1,0,5,1,2,1,21,1,22,86,82,79,206,205,209,1,21,85,85,5,85,87,127,255,248,0,0,0,0,0,0,0,34,2,1,85,85,2,255,255,85,85,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,15,14,126,18,2,2,3,2,2,2,2,2,2,2,2,255,2,2,2,85
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,3,0,0,7,0,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,7,0,0,7,0,0,7,0,0,7,0,0,6,0,0,6,0,0,7,0,0,0,7,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,0,255,255,240,255,255,240,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,1,132,0,1,0,0,252,160,0,42,128,0,134,0,0,204,0,129,16,1,1,144,0,0,128,54,152,0,15,79,0,11,91,0,0,0,0,244,224,0,186,96,0,235,128,0,0,0,0,0,0,59,2,0,192,16,1,0,96,0,0,64,1,0,0,1,0,0,1,97,0,0,255,0,0,63,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,64,24,0,0,63,0,0,0,0,0,0,255,255,255,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,253,85,255,253,84,0,61,84,252,61,4,3,49,68,0,83,49,84,83,53,80,83,53,80,83,49,80,83,53,80,83,53,80,83,53,80,83,53,80,83,53,80,83,53,80,83,49,80,83,49,16,83,49,16,83,49,84,83,49,84,83,61,84,83,49,84,83,61,84,83,204,85,83,204,85,83,240,85,0,83,243,85,83,243,21,83,243,213,83,240,21,83,240,197,83,236,245,83,236,49,83,252,49,83,255,12,83,255,12,83,255,195,83,255,195,3,243,240,255,240,252,252,192,204,0,204,59,3,48,48,255,48,12,170,240,0,252,255,255,255,255,255,0,170,170,170,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,51,48,255,243,48,63,255,255,255,255,204,207,195,192,192,0,240,204,255,255,255,243,204,48,15,192,48,243,204,48,255,255,255,0,192,3,255,0,0,63,0,0,63,0,0,63,0,0,63,0,0,63,0,0,63,0,0,63,0,0,63,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,191,255,255,192,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,128,0,3,128,0,7,128,0,7,0,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,7,0,0,6,0,0,7,128,0,7,128,0,7,128,0,7,128,0,6,192,0,6,192,0,6,96,0,6,96,0,0,6,48,0,6,48,0,6,24,0,6,24,0,6,12,0,6,14,0,6,7,0,6,3,128,6,1,192,6,0,224,6,0,112,6,16,52,6,24,14,12,20,7,236,66,1,240,33,32,0,32,192,0,127,228,4,0,1,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35,124,0,19,94,0,0,0,0,96,136,131,249,252,212,253,156,198,0,0,0,48,70,56,128,61,62,48,71,30,0,0,0,225,224,0,0,0,6,0,0,1,0,0,0,0,0,1,0,0,3,0,0,62,0,255,252,0,255,224,0,127,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,0,0,255,255,255,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,1,232,7,0,0,9,0,0,0,5,131,0,31,255,7,30,224,200,12,0,0,0,0,1,32,0,63,0,1,3,0,120,15,1,0,126,28,3,250,32,31,242,32,176,18,100,1,16,56,1,25,12,1,17,14,6,159,7,255,255,0,7,255,255,3,158,15,0,255,255,0,63,254,0,7,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,160,0,0,120,0,0,27,128,0,7,255,254,0,127,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,103,0,0,61,0,1,103,0,3,0,0,4,0,0,136,0,0,0,144,0,2,96,0,0,56,0,0,18,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,255,192,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,127,255,253,95,255,13,95,255,237,63,255,53,127,255,117,127,255,125,127,255,125,127,255,0,117,127,255,125,127,255,125,127,255,125,124,15,125,127,255,125,127,255,125,127,255,117,127,252,117,127,240,117,127,224,101,127,139,117,126,35,125,124,3,125,92,255,125,82,243,125,124,3,125,95,255,127,95,252,125,95,0,125,84,0,127,84,252,0,127,84,0,127,119,0,127,85,0,127,85,192,127,213,65,127,213,85,127,213,85,127,245,85,127,197,85,63,237,85,255,253,85,254,252,85,191,248,199,56,63,255,250,254,255,60,255,2,255,255,192,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,187,255,255,255,255,255,255,255,255,51,239,255,63,255,255,255,255,255,255,255,255,178,250,255,255,255,255,255,255,255,15,255,252,3,255,255,0,255,243,0,0,255,255,0,255,255,0,255,255,0,255,255,0,255,255,8,255,255,136,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,254,0,0,2,0,0,6,0,0,6,0,0,6,0,0,6,0,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,6,0,0,4,0,0,6,0,0,6,0,0,6,0,0,6,0,0,7,0,0,7,0,0,5,0,0,5,0,0,5,0,0,5,0,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,4,0,0,12,255,255,253,255,255,249,0,0,1,0,0,1,0,0,4,0,0,0,0,0,0,0,0,0,255,255,255,0,255,255,255,0,0,0,1,4,0,1,0,0,232,192,0,115,0,0,4,0,0,152,0,247,32,1,207,160,0,0,0,59,210,0,21,59,0,21,254,0,0,0,0,217,89,0,94,96,0,189,217,0,0,0,0,0,51,4,0,128,32,1,0,0,64,0,0,128,1,0,0,1,128,0,1,225,0,0,255,0,0,127,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,128,16,0,0,63,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,255,255,254,0,0,0,85,85,95,85,85,95,85,85,95,85,85,95,0,0,31,85,85,31,0,0,0,31,85,85,95,0,0,31,64,0,31,85,0,31,0,0,31,85,64,31,80,0,30,64,0,28,64,0,28,0,0,28,0,0,28,0,0,31,0,0,31,0,0,31,0,0,31,0,0,31,0,0,31,0,0,31,0,0,31,0,0,31,0,0,0,31,85,85,95,85,85,95,85,85,95,85,85,95,85,85,95,0,0,3,255,255,255,255,255,255,0,0,11,0,0,15,255,255,255,0,0,3,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,207,255,255,143,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63,255,255,179,255,255,243,255,255,255,255,255,255,255,179,203,255,255,63,255,255,255,255,255,240,255,255,192,255,255,192,255,255,192,255,255,192,255,255,192,0,255,255,192,255,255,192,255,255,128,255,255,194,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,240,63,0,255,240,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,95,255,253,95,255,13,95,255,239,31,255,13,95,255,125,95,255,125,95,255,125,95,255,125,127,255,125,127,255,125,127,255,0,125,127,15,125,127,255,125,127,255,125,127,255,125,127,252,125,95,248,125,95,226,121,95,128,125,95,3,127,92,35,125,92,191,125,94,192,127,95,3,127,83,255,127,87,255,127,87,0,127,84,0,127,212,255,127,84,0,127,213,0,127,213,0,0,127,213,64,127,213,64,127,245,85,127,245,85,127,253,85,127,253,85,15,237,85,255,255,85,255,255,85,46,252,247,60,191,255,254,191,255,12,63,0,255,255,192,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,252,255,255,254,255,255,255,255,255,255,255,255,252,255,255,15,255,255,255,255,255,255,255,255,176,204,255,255,255,255,255,255,255,195,255,255,0,255,255,0,63,255,0,63,255,0,63,255,0,255,255,0,0,191,255,0,191,255,2,63,255,136,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,192,0,63,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
