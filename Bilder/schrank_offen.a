!to "schrank_offen.prg", cbm

!src "rt_macros.a"
!src "rti_macros.a"

*=$C000

            jmp SHOW_IMAGE

HIDE_IMAGE  +RESET_IRQ
            lda #8
            sta $D016
            lda #32
            ldy #11
-           sta 1064,y
            sta 1104,y
            sta 1144,y
            sta 1184,y
            sta 1224,y
            sta 1264,y
            sta 1304,y
            sta 1344,y
            sta 1384,y
            sta 1424,y
            sta 1464,y
            dey
            bne -
            rts

SHOW_IMAGE  sei
            lda $01
            and #%11111110
            sta $01
            ;+COPY_CHAR_ROM $D000, $2000
            +COPY_DATA CHAR_DATA, CHAR_DATA_END, $2400
            +COPY_DATA SPRITE_DATA, SPRITE_DATA_END, $2800
            +RLINE 70
            lda #$0
            sta $D021

            lda $D018
            and #%11110001
            ora #%00001000
            sta $D018

            +INIT_IRQ irq, 22
            +COPY_CHAR CHAR, 1065, CHAR_COL, 55337
            lda $01
            ora #%00000001
            sta $01

            rts

COPY        +COPY

irq:        +START_IRQ

            +SYNC 27

            lda $D016
            sta B_CHAR_MC
            lda CHAR_MC
            sta $D016
            lda $D022
            sta B_CHAR_COL1
            lda CHAR_COL1
            sta $D022
            lda $D023
            sta B_CHAR_COL2
            lda CHAR_COL2
            sta $D023

            ldy #$10
-           lda $D000,y
            sta B_SPRITE_POS,y
            lda SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda $D025,y
            sta B_SPRITE_COL,y
            lda SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda 2040,y
            sta B_SPRITEDATA,y
            dey
            bpl -
            clc
            lda #$A0
            ldy #0
-           sta 2040,Y
            iny
            adc #5
            cmp #$C8
            bne -

            lda $D017
            sta B_SPRITE_YS
            lda #0
            sta $D017
            lda $D01B
            sta B_SPRITE_BG
            lda SPRITE_BG
            sta $D01B
            lda $D01C
            sta B_SPRITE_MC
            lda SPRITE_MC
            sta $D01C
            lda $D01D
            sta B_SPRITE_XS
            lda SPRITE_XS
            sta $D01D
            lda $D015
            sta B_SPRITE_ON
            lda #255
            sta $D015

            +RLINE 52

            lda #42+21
            sta $D001
            sta $D003
            lda #43+21
            sta $D005
            sta $D007
            lda #45+21
            sta $D009
            sta $D00B
            lda #48+21
            sta $D00D
            sta $D00F

            +RLINE 58
            +WAIT 41

 +WAIT 132
 inc 2040
 inc 2041
 +WAIT 32
 lda #84
 sta 53249
 lda #84
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #85
 sta 53253
 lda #85
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #87
 sta 53257
 lda #87
 sta 53259
 +WAIT 33
 inc 2046
 inc 2047
 +WAIT 32
 lda #90
 sta 53261
 lda #90
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #105
 sta 53249
 lda #105
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #106
 sta 53253
 lda #106
 sta 53255
 +WAIT 32
 inc 2044
 inc 2045
 +WAIT 32
 lda #108
 sta 53257
 lda #108
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #111
 sta 53261
 lda #111
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 lda #126
 sta 53249
 lda #126
 sta 53251
 inc 2042
 inc 2043
 +WAIT 20
 lda #127
 sta 53253
 lda #127
 sta 53255
 inc 2044
 inc 2045
 +WAIT 21
 lda #129
 sta 53257
 lda #129
 sta 53259
 +WAIT 76
 inc 2046
 inc 2047
 +WAIT 32
 lda #132
 sta 53261
 lda #132
 sta 53263
 +WAIT 518
 inc 2040
 inc 2041
 +WAIT 32
 inc 2042
 inc 2043
 +WAIT 76
 inc 2044
 inc 2045
 +WAIT 77
 inc 2046
 inc 2047

            +RLINE 147

            lda B_CHAR_MC
            sta $D016
            lda B_CHAR_COL1
            sta $D022
            lda B_CHAR_COL2
            sta $D023

            ldy #$10
-           lda B_SPRITE_POS,y
            sta $D000,y
            dey
            bpl -

            ldy #$09
-           lda B_SPRITE_COL,y
            sta $D025,y
            dey
            bpl -

            ldy #$07
-           lda B_SPRITEDATA,y
            sta 2040,y
            dey
            bpl -

            lda B_SPRITE_YS
            sta $D017
            lda B_SPRITE_BG
            sta $D01B
            lda B_SPRITE_MC
            sta $D01C
            lda B_SPRITE_XS
            sta $D01D
            lda B_SPRITE_ON
            sta $D015

            +END_IRQ

CHAR_MC     !by 8
CHAR_COL1   !by 0
CHAR_COL2   !by 0
SPRITE_POS  !by 32,42,53,42,70,43,70,43,35,45,34,45,32,48,71,48,0
SPRITE_COL  !by 8,12,6,1,9,2,11,2,9,11
SPRITE_BG   !by 255
SPRITE_MC   !by 235
SPRITE_XS   !by 255

B_CHAR_MC     !by 0
B_CHAR_COL1   !by 0
B_CHAR_COL2   !by 0
B_SPRITE_POS  !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
B_SPRITE_COL  !by 0,0,0,0,0,0,0,0,0,0
B_SPRITE_BG   !by 0
B_SPRITE_MC   !by 0
B_SPRITE_XS   !by 0
B_SPRITE_YS   !by 0
B_SPRITE_ON   !by 0
B_SPRITEDATA

*=$B1EE

CHAR        !by 128,139,130,158,167,177,186,186,186,186,186,129,140,149,159,168,178,187,196,203,211,220,130,141,150,160,169,179,188,197,204,212,221,131,142,151,161,170,180,189,142,189,213,222,132,143,152,162,171,181,190,198,205,214,223,133,144,153,163,172,182,191,199,206,215,224,134,145,154,145,173,145,192,145,207,216,225,135,146,155,164,174,183,193,200,208,217,223,136,147,156,165,175,184,194,201,209,218,226,137,148,157,166,176,185,195,202,210,219,227,138,138,138,138,138,138,138,138,138,138,138
CHAR_COL    !by 14,14,9,14,14,14,6,6,6,6,6,11,9,9,9,9,9,8,8,11,8,9,11,9,9,9,9,8,8,8,8,8,8,11,11,9,12,9,12,12,11,12,11,9,2,2,9,2,2,0,2,0,2,0,9,1,1,9,1,2,2,2,1,2,1,9,9,9,9,9,9,9,11,9,2,11,9,1,1,9,1,2,2,2,1,2,1,9,1,1,8,1,2,2,2,1,2,1,8,9,9,15,15,0,15,11,15,11,12,9,12,12,12,12,12,12,12,12,12,12,12
CHAR_DATA   !by 12,96,25,0,0,4,0,0,255,3,28,255,0,0,0,0,0,0,0,0,0,0,0,255,255,255,8,0,0,0,0,15,0,0,63,56,56,56,56,63,0,13,9,13,0,0,0,0,255,255,255,255,240,224,224,192,0,0,0,0,0,0,13,9,13,0,0,0,0,0,0,0,176,144,144,208,144,208,0,0,255,255,255,255,255,255,255,255,0,0,128,96,0,0,0,0,63,255,255,0,0,0,0,128,64,128,0,0,0,0,255,0,255,255,0,0,0,0,0,255,0,0,255,3,3,3,3,255,0,54,166,180,0,0,0,0,255,255,255,255,0,0,0,0,0,0,0,0,0,0,54,166,180,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,255,255,255,0,64,64,64,0,64,64,64,64,64,0,255,0,0,0,0,0,0,255,255,56,48,48,32,32,32,32,32,32,32,32,32,32,96,0,0,255,255,255,255,255,56,48,48,32,32,32,32,32,32,32,32,32,0,0,224,255,255,255,255,255,0,0,0,0,0,31,0,0,0,0,0,0,0,24,0,0,224,252,255,0,0,0,0,16,40,16,0,0,0,0,255,0,58,127,255,248,248,0,0,0,0,0,255,1,1,1,1,255,0,155,211,218,0,0,0,0,0,0,0,0,0,0,155,211,218,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,254,0,25,0,192,248,35,0,0,8,8,0,8,8,8,8,8,0,255,0,0,0,0,240,248,255,255,28,0,0,207,206,206,206,206,207,207,204,205,204,207,143,0,0,255,255,255,255,28,24,24,16,206,206,206,206,207,207,204,205,204,207,143,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,7,7,129,0,0,0,0,4,241,251,255,255,255,255,0,0,96,246,255,249,200,0,0,0,0,0,0,255,198,66,66,0,255,178,150,146,255,255,0,0,0,0,0,0,255,255,178,150,146,255,255,0,0,0,0,0,0,0,0,0,0,192,238,0,255,255,255,255,255,255,255,0,0,0,0,0,253,255,253,253,253,255,253,253,253,253,0,0,0,0,255,255,255,0,0,0,0,0,227,227,227,227,227,227,227,99,99,227,227,195,0,0,0,0,0,0,240,241,241,16,227,227,227,227,227,227,99,99,227,227,195,0,0,0,0,0,7,255,255,224,0,0,0,0,0,0,0,0,255,255,255,254,252,254,255,255,255,255,0,0,0,0,0,127,49,16,16,0,0,211,154,219,0,0,0,0,0,0,0,0,0,0,211,154,219,0,0,0,0,0,0,0,0,0,0,0,30,248,0,0,255,143,128,255,0,0,0,0,127,255,255,255,255,255,0,0,0,0,249,57,57,57,57,249,249,153,153,185,249,241,0,0,0,0,0,0,0,0,0,249,57,57,57,57,249,249,153,153,185,249,241,0,0,0,0,0,0,255,255,127,0,0,0,0,0,0,0,0,255,127,127,255,127,127,127,255,127,127,0,0,255,255,4,0,0,0,0,127,0,0,0,63,24,8,8,0,0,105,77,109,0,0,0,0,0,0,0,0,127,255,255,0,0,0,0,0,0,0,105,77,109,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,31,3,143,0,0,0,0,64,31,191,255,255,255,255,0,0,0,0,0,0,0,255,255,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0,255,255,255,255,255,1,1,1,1,0,0,7,255,255,255,255,255,9,11,9,9,13,13,0,0
CHAR_DATA_END
SPRITE_DATA !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,42,0,170,170,170,170,170,162,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,85,85,85,85,85,85,85,85,85,81,81,84,85,85,84,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,0,0,0,0,0,0,0,3,204,0,255,255,255,255,252,60,255,252,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,21,1,4,17,1,4,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,64,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,16,0,4,16,0,4,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,85,85,85,0,85,85,85,85,85,85,85,85,85,85,85,85,68,16,21,64,0,0,64,0,0,64,3,192,127,255,255,127,192,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,21,85,85,85,85,85,21,85,85,17,69,65,17,85,81,81,85,85,21,85,85,21,85,85,21,85,85,21,0,0,0,0,0,0,0,0,0,63,0,0,0,255,255,255,243,243,255,240,195,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,17,0,20,17,0,20,17,0,0,0,0,0,0,128,168,2,0,168,2,128,168,2,0,0,0,1,1,1,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,17,0,0,17,0,0,0,0,0,0,128,168,2,0,168,2,128,168,2,0,0,0,1,1,1,85,85,85,0,85,85,85,85,85,85,85,85,85,85,85,85,0,84,0,0,0,0,0,0,0,12,3,252,255,255,255,15,255,207,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,224,13,192,1,15,118,120,135,255,249,0,0,0,0,128,0,0,0,64,0,128,64,16,136,0,24,140,70,16,8,68,0,128,64,0,128,0,0,128,64,0,128,64,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,24,0,0,56,0,0,255,255,255,255,255,255,1,128,192,1,128,128,1,128,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,1,128,0,0,128,0,0,0,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,1,128,192,1,128,128,1,128,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,1,0,128,3,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,255,255,252,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,168,168,170,8,128,130,88,144,146,24,144,150,24,144,150,168,168,170,168,168,170,168,168,170,168,168,170,168,168,170,168,170,170,169,169,170,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,168,170,0,128,130,16,144,134,16,144,150,16,144,150,168,168,170,168,168,170,168,168,170,168,168,170,168,168,170,170,170,170,169,169,170,85,85,85,85,85,85,0,85,85,85,85,85,85,85,85,85,85,1,85,0,0,1,0,0,0,3,252,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252,63,255,0,240,15,249,32,6,120,128,3,220,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,247,239,255,224,107,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,127,127,255,255,127,255,255,127,1,1,0,1,1,0,1,1,0,73,41,36,73,41,36,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,127,127,255,255,127,255,255,127,1,1,0,1,1,0,1,1,0,73,41,32,73,41,32,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,63,0,127,255,255,127,255,255,255,248,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,85,85,85,85,85,85,85,85,85,85,85,85,69,81,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,0,0,0,0,15,60,0,63,255,255,255,255,255,240,255,255,240,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,42,2,128,2,70,145,22,134,145,22,134,145,22,170,170,42,170,170,42,170,170,42,170,170,42,170,170,42,170,170,42,170,170,106,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,170,130,130,0,134,145,4,134,145,4,134,145,4,170,170,42,170,170,42,170,170,42,170,170,42,170,170,42,170,170,42,170,170,106,85,85,85,85,85,85,85,85,85,85,85,85,0,85,85,85,4,80,85,0,0,0,0,0,0,64,15,192,255,255,255,255,195,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,130,160,0,10,168,130,170,170,162,170,170,170,0,0,0,0,85,85,85,85,85,85,85,85,85,85,85,85,81,81,86,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,170,170,170,0,0,0,0,15,12,0,15,255,255,255,255,255,254,191,255,254,190,170,170,170,170,170,170,128,160,160,0,128,128,160,128,128,160,128,128,128,128,128,128,133,148,149,133,148,149,133,148,149,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,64,64,64,85,85,85,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,128,160,160,0,128,128,160,128,128,160,128,128,128,128,128,128,133,148,144,133,148,144,133,148,144,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,64,64,64,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,132,16,21,64,0,0,0,64,0,0,128,3,192,127,255,255,191,192,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
            !by 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,168,42,170,170,168,162,170,138,162,8,138,0,170,170,170,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,0,0,0,170,170,170,234,170,170,250,170,170,255,255,251,255,255,255,255,255,255,0,0,0,0,0,0,170,170,170,0,170,170,170,170,170,170,2,2,2,2,2,2,86,82,82,86,90,86,86,90,86,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,5,1,1,85,85,85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,170,170,170,0,170,170,170,170,170,170,2,2,2,2,2,2,6,82,70,6,90,86,6,90,86,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,5,1,1,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,86,161,85,170,170,169,0,170,170,169,171,254,169,255,207,253,255,255,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
SPRITE_DATA_END
